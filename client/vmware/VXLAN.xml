<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" 
			 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
			 xsi:schemaLocation="http://peachfuzzer.com/2012/Peach ../peach.xsd" 
			 author="Deja Vu Security, LLC" description="Virtual Extensible LAN PIT" version="0.0.2">

	<!-- Copyright 2013 (c) Deja vu Security, LLC. All rights reserved. -->
	<!-- Requires Linux Peach 3.0 and RawEther publisher -->
	
	<Include ns="Generic" src="file:##Path##/CommonHeaders/GenericDataTypes.xml"/>

	<!-- Headers -->
	<Include ns="Ethernet" src="file:##Path##/CommonHeaders/EthernetHeader.xml"/>

	<Include ns="IPv4" src="file:##Path##/CommonHeaders/IPv4Header.xml"/>
	<Include ns="IPv6" src="file:##Path##/CommonHeaders/IPv6Header.xml"/>

	<Include ns="TCP" src="file:##Path##/CommonHeaders/TCPHeader.xml"/>
	<Include ns="UDP" src="file:##Path##/CommonHeaders/UDPHeader.xml"/>
	<Include ns="ICMP" src="file:##Path##/CommonHeaders/ICMPHeader.xml"/>

	<Include ns="VLAN" src="file:##Path##/CommonHeaders/VLANHeader.xml"/>
	
	<Include ns="ARP" src="file:##Path##/ARP.xml"/>
	<Include ns="CDP" src="file:##Path##/CDP.xml"/>
	<Include ns="LACP" src="file:##Path##/LACP.xml"/>
	<Include ns="MLD" src="file:##Path##/MLD.xml"/>
	<Include ns="IGMP" src="file:##Path##/IGMP.xml"/>
	<Include ns="LLDP" src="file:##Path##/LLDP.xml"/>

	<!-- Agents -->
	<Include ns="CommonAgents" src="file:##Path##/CommonAgents.xml"/>

	<DataModel name="MTU">
		<Number size="16" value="1500" signed="false"/>
	</DataModel>


	<!-- Used as the "Inner" Data for VXLAN Data Model -->
  <DataModel name="VXLANHeader">
		<Flags size="8" endian="big" >
			<Flag position="4" value="1" size="1"/>
		</Flags>
		<Number name="LargeReserve" size="24" endian="big"/>
		<Number name="VNI" 	    size="24" value="7639335" endian="big"/>
		<Number name="SmallReserve" size="8" endian="big"/>
		<Block name="EtherHeader" ref="Ethernet:EthernetHeader">
			<Blob name="Src" valueType="hex" value="##SourceMAC##"/>
			<Blob name="Dest" valueType="hex" value="##TargetMAC##"/>
			<Blob name="Type" valueType="hex" value="0800"/>
		</Block>
		<Block name="VXLANPayload"/>
	</DataModel>

  <DataModel name="VXLAN">
    <Block name="OuterEtherHeader" ref="Ethernet:EthernetHeader">
      <Blob name="Dest" valueType="hex" value="ffffffffffff"/>
      <Blob name="Src"  valueType="hex" value="##OuterSourceMAC##"/>
      <Blob name="Type" valueType="hex" value="0800"/>
    </Block>
    <Block name="OuterIP" ref="IPv4:IPv4Header">
			<Number name="Header.Protocol" size="8" endian="big" value="17"/>
			<Blob name="Header.SrcIP" mutable="false" value="##OuterSourceIPv4##">
				<Transformer class="Ipv4StringToNetworkOctet" />
			</Blob>
			<Blob name="Header.DestIP" mutable="false" value="##OuterTargetIPv4##">
				<Transformer class="Ipv4StringToNetworkOctet" />
			</Blob>
      <Block name="IPv4Payload" ref="UDP:UDPHeader">
				<Number name="Header.SrcPort"  size="16" endian="big" value="9029"/>
				<Number name="Header.DestPort" size="16" endian="big" value="9029"/>
				<Number name="Header.Checksum" size="16" endian="big"/> <!-- VXLAN has no inner CRC -->
				<Block name="UdpPayload">
					<Block name="VXHeader" ref="VXLANHeader">
						<Blob name="EtherHeader.Type" valueType="hex" value="0800"/>
						<Block name="VXLANPayload">
							<Block name="InnerIP" ref="IPv4:IPv4Header">
								<Number name="Header.Protocol" size="8" endian="big" value="17"/>
								<Block name="IPv4Payload" ref="UDP:UDPHeader">
									<Number name="Header.SrcPort" size="16" endian="network" value="1234"/>
									<Number name="Header.DestPort" size="16" endian="network" value="1234"/>
									<Block name="UdpPayload">
										<Blob value="AAAAAA"/>
									</Block>
								</Block>
							</Block>
						</Block>
					</Block>
				</Block>
      </Block>
    </Block>
  </DataModel>

	<!-- VXLAN Empty IPv4 Frame -->
	<DataModel name="IPv4EmptyPacketInVxlan">
		<Block name="VXLAN" >
			<Block name="OuterEtherHeader" ref="Ethernet:EthernetHeader">
      <Blob name="Dest" valueType="hex" value="ffffffffffff"/>
      <Blob name="Src"  valueType="hex" value="##OuterSourceMAC##"/>
      <Blob name="Type" valueType="hex" value="0800"/>
    </Block>
    <Block name="OuterIP">
			<Block name="Header">
				<Flags size="16" endian="big">
					<Flag name="Version" position="0" size="4" valueType="hex" value="04"/>
					<Flag name="HeaderLength" position="4" size="4" valueType="hex">
						<Relation type="size" of="Header" expressionGet="size * 4" expressionSet="size / 4"/>
					</Flag>
					<Flag name="DSCP" position="8" size="6" valueType="hex" value="00"/>
					<Flag name="ECN" position="14" size="2" valueType="hex" value="00"/>
				</Flags>
				<Number name="TotalLength" size="16" endian="big" valueType="hex">
					<!--###Should be set to the entire packet (IPv4Header + Payload)###-->
					<Relation type="size" of="OuterIP"/> 
				</Number>
				<Number name="Identification" size="16" endian="big" value="0"/>
				<Flags name="Flags" size="16" endian="big">
					<Flag name="Reserved" position="0" size="1" valueType="hex" value="00"/>
					<Flag name="DF" position="1" size="1" valueType="hex" value="01"/>
					<Flag name="MF" position="2" size="1" valueType="hex" value="00"/>
					<Flag name="FragmentOffset" position="3" size="13" valueType="hex" value="00 00"/>
				</Flags>
				<Number name="TTL" size="8" endian="big" valueType="hex" value="40"/>
				<!-- http://www.iana.org/assignments/protocol-numbers/protocol-numbers.xml -->
				<Number name="Protocol" size="8" endian="big" valueType="hex" value="01"/>
				<Number name="Checksum" size="16" endian="big">
					<Fixup class="checksums.IcmpChecksumFixup">
						<Param name="ref" value="Header"/>
					</Fixup>
				</Number>
				<Blob name="SrcIP" mutable="false" value="##OuterSourceIPv4##">
					<Transformer class="Ipv4StringToNetworkOctet" />
				</Blob>
				<Blob name="DestIP" mutable="false" value="##OuterTargetIPv4##">
					<Transformer class="Ipv4StringToNetworkOctet" />
				</Blob>
				<Blob name="Options"/>
			</Block>
      <Block name="IPv4Payload">
				<Block name="Header">
					<Number name="SrcPort" size="16" endian="network"/>
					<Number name="DestPort" size="16" endian="network"/>
					<Number name="Length" size="16" endian="network">
						<Relation type="size" of="IPv4Payload" />
					</Number>
					<Number name="Checksum" size="16" endian="big"/>
				</Block>
				<Block name="UdpPayload">
					<Block name="VXHeader" ref="VXLANHeader">
						<Blob name="EtherHeader.Type" valueType="hex" value="0800"/>
						<Block name="VXLANPayload">
							<Block name="InnerIP">
								<Block name="Header">
									<Flags size="16" endian="big">
										<Flag name="Version" position="0" size="4" valueType="hex" value="04"/>
										<Flag name="HeaderLength" position="4" size="4" valueType="hex">
											<Relation type="size" of="Header" expressionGet="size * 4" expressionSet="size / 4"/>
										</Flag>
										<Flag name="DSCP" position="8" size="6" valueType="hex" value="00"/>
										<Flag name="ECN" position="14" size="2" valueType="hex" value="00"/>
									</Flags>
									<Number name="TotalLength" size="16" endian="big" valueType="hex">
										<!--###Should be set to the entire packet (IPv4Header + Payload)###-->
										<Relation type="size" of="InnerIP"/> 
									</Number>
									<Number name="Identification" size="16" endian="big" value="0"/>
									<Flags name="Flags" size="16" endian="big">
										<Flag name="Reserved" position="0" size="1" valueType="hex" value="00"/>
										<Flag name="DF" position="1" size="1" valueType="hex" value="01"/>
										<Flag name="MF" position="2" size="1" valueType="hex" value="00"/>
										<Flag name="FragmentOffset" position="3" size="13" valueType="hex" value="00 00"/>
									</Flags>
									<Number name="TTL" size="8" endian="big" valueType="hex" value="40"/>
									<!-- http://www.iana.org/assignments/protocol-numbers/protocol-numbers.xml -->
									<Number name="Protocol" size="8" endian="big" valueType="hex" value="01"/>
									<Number name="Checksum" size="16" endian="big">
										<Fixup class="checksums.IcmpChecksumFixup">
											<Param name="ref" value="Header"/>
										</Fixup>
									</Number>
									<Blob name="SrcIP" mutable="false" value="##SourceIPv4##">
										<Transformer class="Ipv4StringToNetworkOctet" />
									</Blob>
									<Blob name="DestIP" mutable="false" value="##TargetIPv4##">
										<Transformer class="Ipv4StringToNetworkOctet" />
									</Blob>
									<Blob name="Options"/>
								</Block>
								<Block name="IPv4Payload"/>
							</Block>
						</Block>
					</Block>
				</Block>
      </Block>
    </Block>
		</Block>
	</DataModel>
  
	<!-- VXLAN Empty IPv6 Frame -->
	<DataModel name="IPv6EmptyPacketInVxlan">
		<Block name="VXLAN"  ref="VXLAN">
			<Blob name="OuterIP.IPv4Payload.UdpPayload.VXHeader.EtherHeader.Type" valueType="hex" value="86dd"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload">
				<Block name="InnerIP" ref="IPv6:IPv6Header">
					<Number name="NextHeader" size="8" endian="big" value="59"/>
					<Number name="PayloadLength" value="0" size="16"/>
					<Block name="IPv6Payload">
					</Block>
				</Block>
			</Block>
		</Block>
	</DataModel>

	<DataModel name="IPv6ICMPInVxlan">
		<!-- good -->
		<Block name="VXLAN"  ref="IPv6EmptyPacketInVxlan">
			<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.PayloadLength" 
							size="16" endian="big">
				<Relation type="size" of="IPv6Payload" />
			</Number>
			<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.NextHeader" size="8" endian="big" value="58"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.IPv6Payload" ref="ICMP:ICMPv6Header"/>
		</Block>
	</DataModel>

	<DataModel name="IPv6HopByHopInVxlan">
		<!-- good -->
		<Block name="VXLAN"  ref="IPv6EmptyPacketInVxlan">
			<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.PayloadLength" 
							size="16" endian="big" value="65535">
				<Relation type="size" of="IPv6Payload" />
			</Number>
			<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.NextHeader" size="8" endian="big" value="0"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.IPv6Payload" ref="IPv6:HopByHop"/>
		</Block>
	</DataModel>


	<!-- A jumbogram would have to be passed within another jumbogram -->
	<!-- <DataModel name="IPv6JumbogramInVxlan"> -->
	<!-- 	<Block name="VXLAN"  ref="IPv6EmptyPacketInVxlan"> -->
	<!-- 		<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.PayloadLength" -->
	<!-- 						size="16" endian="big" value="0"/> -->
	<!-- 		<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.NextHeader" size="8" endian="big" value="0"/> -->
	<!-- 		<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.IPv6Payload" ref="IPv6:JumboFrame"/> -->
	<!-- 	</Block> -->
	<!-- </DataModel> -->


	<DataModel name="IPv6Fragment1InVxlan">
		<!-- good -->
		<Block name="VXLAN"  ref="IPv6EmptyPacketInVxlan">
			<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.PayloadLength" 
							size="16" endian="big" value="65535">
				<Relation type="size" of="IPv6Payload" />
			</Number>
			<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.NextHeader" size="8" endian="big" value="44"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.IPv6Payload" ref="IPv6:Fragment">
				<Flags name="Flags" size="16" endian="big">
					<Flag name="Offset" size="13" position="0" value="0"/>
					<Flag name="Res" size="2" position="13"/>
					<Flag name="Mflag" size="1" position="15" value="1"/>
				</Flags>
				<Number name="Identification" size="32" endian="big" value="374625"/>
				<Blob name="Data" length="12"/>
			</Block>
		</Block>
	</DataModel>

	<DataModel name="IPv6Fragment2InVxlan">
		<!-- good -->
		<Block name="VXLAN"  ref="IPv6Fragment1InVxlan">
			<Flags name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.IPv6Payload.Flags" size="16" endian="big">
					<Flag name="Offset" size="13" position="0" value="12"/> <!-- This is relative to the last frag... -->
					<Flag name="Res" size="2" position="13"/>
					<Flag name="Mflag" size="1" position="15" value="1"/>
			</Flags>
		</Block>
	</DataModel>


	<DataModel name="IPv6Fragment3InVxlan">
		<!-- good -->
		<Block name="VXLAN"  ref="IPv6Fragment1InVxlan">
			<Flags name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.IPv6Payload.Flags" size="16" endian="big">
					<Flag name="Offset" size="13" position="0" value="24"/> <!-- This is relative to the last frag... -->
					<Flag name="Res" size="2" position="13"/>
					<Flag name="Mflag" size="1" position="15" value="0"/>
			</Flags>
		</Block>
	</DataModel>

	<DataModel name="IPv6DestinationOptionsInVxlan">
		<!-- good -->
		<Block name="VXLAN"  ref="VXLAN">
			<Blob name="OuterIP.IPv4Payload.UdpPayload.VXHeader.EtherHeader.Type" valueType="hex" value="86dd"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload">
				<Block name="InnerIP" ref="IPv6:IPv6Header">
					<Number name="NextHeader" size="8" endian="big" value="60"/>
					<Number name="PayloadLength" value="0" size="16">
						<Relation type="size" of="IPv6Payload"/>
					</Number>
					<Block name="IPv6Payload">
						<Block ref="IPv6:DestinationOptions">
							<Block name="Options">
								<Block ref="Generic:ValueLenTLV" name="HomeAddressOption">
									<Number name="Type" size="8" endian="big" value="201"/>
									<Number name="Length" size="8">
										<Relation type="size" of="Value"/>
									</Number>
									<Block name="Value">
										<Blob length="16" valueType="hex"/>
									</Block>
								</Block>
							</Block>
						</Block>
						<Padding  alignment="64"/>
					</Block>
				</Block>
			</Block>
		</Block>
	</DataModel>
	
		<DataModel name="MLDInVxlan">
		<!-- good -->
		<Block name="VXLAN"  ref="VXLAN">
			<Blob name="OuterIP.IPv4Payload.UdpPayload.VXHeader.EtherHeader.Type" valueType="hex" value="86dd"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload">
				<Block name="InnerIP" ref="IPv6:IPv6Header">
					<Number name="NextHeader" size="8" endian="big" value="58"/>
					<Number name="PayloadLength" value="0" size="16">
						<Relation type="size" of="IPv6Payload"/>
					</Number>
					<Block name="IPv6Payload">
						<Block name="MLDHeader" ref="MLD:MLDHeader"/>	
					</Block>
				</Block>
			</Block>
		</Block>
	</DataModel>

	<!-- VXLAN IPv4 Frame + TCP Payload -->
	<DataModel name="IPv4TCPInVxlan">
		<Block name="VXLAN"  ref="IPv4EmptyPacketInVxlan">
			<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.Header.Protocol" size="8" endian="big" value="6"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.IPv4Payload" ref="TCP:Packet"/>
		</Block>
	</DataModel>
	<!-- VXLAN IPv6 Frame + TCP Payload -->
	<DataModel name="IPv6TCPInVxlan">
		<Block name="VXLAN"  ref="IPv6EmptyPacketInVxlan">
			<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.PayloadLength" 
							size="16" endian="big" value="65535">
				<Relation type="size" of="IPv6Payload" />
			</Number>
			<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.NextHeader" size="8" endian="big" value="6"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.IPv6Payload" ref="TCP:Packet"/>
		</Block>
	</DataModel>
	<!-- VXLAN IPv4 Frame + UDP Payload -->
	<DataModel name="IPv4UDPInVxlan">
		<Block name="VXLAN"  ref="IPv4EmptyPacketInVxlan">
			<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.Header.Protocol" size="8" endian="big" value="17"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.IPv4Payload" ref="UDP:UDPHeader"/>
		</Block>
	</DataModel>

	<!-- VXLAN IPv6 Frame + UDP Payload -->
	<DataModel name="IPv6UDPInVxlan">
		<Block name="VXLAN" ref="IPv6EmptyPacketInVxlan">
			<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.PayloadLength" size="16" endian="big" value="65535">
				<Relation type="size" of="IPv6Payload"/>
			</Number>
			<Number name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.NextHeader" size="8" endian="big" value="17"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload.InnerIP.IPv6Payload" ref="UDP:UDPHeader"/>
		</Block>
	</DataModel>
	
	<DataModel name="ARPInVxlan">
		<Block name="VXLAN"  ref="VXLAN">
			<Blob name="OuterIP.IPv4Payload.UdpPayload.VXHeader.EtherHeader.Type" valueType="hex" value="0806"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload">
				<Block name="InnerIP" ref="ARP:ARP"/>
			</Block>
		</Block>
	</DataModel>

	<DataModel name="CDPInVxlan">
		<Block name="VXLAN"  ref="VXLAN">
			<Blob name="OuterIP.IPv4Payload.UdpPayload.VXHeader.EtherHeader"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload">
				<Block name="InnerIP" ref="CDP:CDP"/>
			</Block>
		</Block>
	</DataModel>

	<DataModel name="LACPInVxlan">
		<Block name="VXLAN"  ref="VXLAN">
			<Blob name="OuterIP.IPv4Payload.UdpPayload.VXHeader.EtherHeader.Type" valueType="hex" value="8809"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload">
				<Block name="InnerIP" ref="LACP:LACP"/>
			</Block>
		</Block>
	</DataModel>

	<DataModel name="LLDPInVxlan">
		<Block name="VXLAN"  ref="VXLAN">
			<Blob name="OuterIP.IPv4Payload.UdpPayload.VXHeader.EtherHeader.Type" valueType="hex" value="88cc"/>
			<Block name="OuterIP.IPv4Payload.UdpPayload.VXHeader.VXLANPayload">
				<Block name="InnerIP" ref="LLDP:LLDP"/>
			</Block>
		</Block>
	</DataModel>


	<!-- StateModel for VXLAN  -->
	<StateModel name="TheState" initialState="Initial">
		<State name="Initial">
			<Action type="output">
				<DataModel ref="VXLAN"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv4EmptyPacketInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6EmptyPacketInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6ICMPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6HopByHopInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6Fragment1InVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6Fragment2InVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6Fragment3InVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6DestinationOptionsInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv4TCPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv4UDPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6UDPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6TCPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="ARPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="CDPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="LACPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="LLDPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="MLDInVxlan"/>
			</Action>
		</State>
	</StateModel>

	<StateModel name="MtuFuzzStates" initialState="Initial">
		<State name="Initial">
			<Action type="setProperty" property="MTU">
				<DataModel ref="MTU"/>
			</Action>
			<Action type="output">
				<DataModel ref="VXLAN"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv4EmptyPacketInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6EmptyPacketInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6ICMPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6HopByHopInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6Fragment1InVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6Fragment2InVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6Fragment3InVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6DestinationOptionsInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv4TCPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv4UDPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6UDPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="IPv6TCPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="ARPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="CDPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="LACPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="LLDPInVxlan"/>
			</Action>
			<Action type="output">
				<DataModel ref="MLDInVxlan"/>
			</Action>
		</State>
	</StateModel>

	<!-- Default test for fuzzing VXLAN -->
	<Test name="Default">
		<!-- The order of agents has importance -->
		<!-- <Agent ref="CommonAgents:Local"/> -->
		<!-- <Publisher class="RawEther"> -->
		<!-- 	<Param name="Interface" value="##Interface##"/> -->
		<!-- 	<Param name="Protocol" value="ETH_P_8021Q"/> -->
		<!-- </Publisher> -->

		<Publisher class="ConsoleHex"/>

		<StateModel ref="TheState"/>
		<Strategy class="##Strategy##"/>
		<Logger class="File">
			<Param name="Path" value="##LoggerPath##"/>
		</Logger>
	</Test>

	<!-- <Test name="MtuFuzz"> -->
	<!-- 	<StateModel ref="MtuFuzzStates"/> -->
		<!-- The order of agents has importance -->
	<!-- 	<Agent ref="CommonAgents:Local"/> -->
	<!-- 	<Publisher class="RawEther"> -->
	<!-- 		<Param name="Interface" value="##Interface##"/> -->
	<!-- 		<Param name="Protocol" value="ETH_P_8021Q"/> -->
	<!-- 	</Publisher> -->
	<!-- 	<Strategy class="##Strategy##"/> -->
	<!-- 	<Logger class="File"> -->
	<!-- 		<Param name="Path" value="##LoggerPath##"/> -->
	<!-- 	</Logger> -->
	<!-- </Test> -->

</Peach>
