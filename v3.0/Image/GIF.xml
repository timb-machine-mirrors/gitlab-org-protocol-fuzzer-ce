<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
			 xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"  
       author="Deja Vu Security, LLC" description="GIf PIT" version="0.0.2">
	<!-- Copyright (c) Deja Vu Security, LLC 2013 -->

	<Include ns="States" src="file:##Path##/_Common/Models/Image/GIF_States.xml"/>

  <Agent name="TheAgent">
    <Monitor class="WindowsDebugger">
      <Param name="CommandLine" value="C:\\windows\\system32\\mspaint.exe fuzzed.gif"/>
      <Param name="StartOnCall" value="FuzzMe"/>
      <Param name="CpuKill" value="true"/>
    </Monitor>

    <Monitor class="PageHeap">
      <Param name="Executable" value="mspaint.exe"/>
    </Monitor>
  </Agent>

  <!-- LINUX 
    <Agent name="TheAgent" location="http://127.0.0.1:9000">
      <Monitor class="debugger.UnixDebugger">
        <Param name="Command" value="/bin/target" />
        <Param name="Params" value="fuzzed.gif" />
        <Param name="StartOnCall" value="FuzzMe" />
      </Monitor>
    </Agent> 
    -->

  <!-- OSX
    <Agent name="TheAgent" location="http://127.0.0.1:9000">
      <Monitor class="osx.CrashWrangler">
        <Param name="Command" value="/Applications/Target/TargetName" />
        <Param name="Arguments" value="fuzzed.gif" />
        <Param name="ExecHandler" value="./exc_handler" />
        <Param name="StartOnCall" value="FuzzMe" />
      </Monitor>
    </Agent>
     -->


  <!-- **************
        TEST SECTION  
       ************** -->
  <Test name="Default">
		<StateModel ref="States:TheStateModel"/>
    
		<Agent ref="TheAgent"/>
    
    <Publisher name="writer" class="file.FileWriter">
      <Param name="FileName" value="fuzzed.gif"/>
    </Publisher>

    <!-- Command Line Launcher: Win/Lin/OSX  With Debugger -->
    <!--Publisher name="launch" class="process.DebuggerLauncher"/-->

    <!-- GUI Launcher: WINDOWS ONLY -->
    <!--
     <Publisher name="launch" class="process.DebuggerLauncherGui"> 
      <Param name="WindowName" value="GUI Window Name" /> 
     </Publisher> 
     -->
		 
	 <Strategy class="##Strategy##"/>

		<Logger class="File">
			<Param name="Path" value="##LoggerPath##"/>
		</Logger>
  </Test>
</Peach>
<!--END-->
