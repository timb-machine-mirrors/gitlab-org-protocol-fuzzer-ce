<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://peachfuzzer.com/2012/Peach ../peach.xsd" 
       author="Deja Vu Security, LLC" description="Internet Protocol Version 4 PIT" version="0.0.2">
	<!-- Copyright (c) Deja Vu Security, LLC. 2013 -->
		
	<Include ns="DataModels" src="file:##Path##/_Common/Models/Net/ICMPv4_Data.xml"/>
		
	<DataModel name="IPv4">
    <Block name="Header">
      <Flags size="16" endian="big">
        <Flag name="Version" position="0" size="4" valueType="hex" value="04"/>
        <Flag name="HeaderLength" position="4" size="4" valueType="hex">
          <Relation type="size" of="Header" expressionGet="size * 4" expressionSet="size / 4"/>
        </Flag>
        <Flag name="DSCP" position="8" size="6" valueType="hex" value="00"/>
        <Flag name="ECN" position="14" size="2" valueType="hex" value="00"/>
      </Flags>
      <Number name="TotalLength" size="16" endian="big" valueType="hex">
        <Relation type="size" of="IPv4"/>
      </Number>
      <Number name="Identification" size="16" endian="big" value="0"/>
      <Flags name="Flags" size="16" endian="big">
        <Flag name="Reserved" position="0" size="1" valueType="hex" value="00"/>
        <Flag name="DF" position="1" size="1" valueType="hex" value="01"/>
        <Flag name="MF" position="2" size="1" valueType="hex" value="00"/>
        <Flag name="FragmentOffset" position="3" size="13" valueType="hex" value="00 00"/>
      </Flags>
      <Number name="TTL" size="8" endian="big" valueType="hex" value="40"/>
      <Number name="Protocol" size="8" endian="big" valueType="hex" value="01"/>
      <Number name="Checksum" size="16" endian="big">
        <Fixup class="checksums.IcmpChecksumFixup">
          <Param name="ref" value="Header"/>
        </Fixup>
      </Number>
      <Number name="SrcIP" size="32" endian="big" valueType="hex" value="##SourceIPBytes##" mutable="false"/>
      <Number name="DestIP" size="32" endian="big" valueType="hex" value="##TargetIPBytes##" mutable="false"/> <!--These fields must be nonmutable on windows-->
      <Blob name="Options"/>
    </Block>
		<Block name="Payload" ref="DataModels:ICMPv4Header"/>
  </DataModel>
</Peach>
<!--END-->