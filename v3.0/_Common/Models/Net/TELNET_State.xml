<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
			 xsi:schemaLocation="http://peachfuzzer.com/2012/Peach ../peach.xsd"
       author="Deja Vu Security, LLC" description="Telnet Command Protocol PIT StateModels" version="0.0.2">
	<!-- Copyright (c) Deja Vu Security, LLC 2013 -->
	
	<Include ns="DataModels" src="file:##Path##/_Common/Models/Net/TELNET_Data.xml"/>
	
	<!-- Telnet Simple State Model -->
  <StateModel name="AgentToHost" initialState="Initial">
		<State name="Initial">
	
	  <!-- Telnet Start/Negotiate Session -->
      <Action name="TelnetSendNegotiate" type="output" publisher="TcpHandler">
        <DataModel ref="DataModels:TelnetConnect" />
      </Action>
	  
      <!-- Wait for "Login:" Prompt -->
	  <Action name="TelnetListenLogin" type="input" publisher="TcpHandler">
	    <DataModel ref="DataModels:TelnetLoginPrompt" />
	  </Action>

	  <!-- Telnet Send Username Value -->
      <Action name="TelnetSendUsername" type="output" publisher="TcpHandler">
        <DataModel ref="DataModels:TelnetUsername" />
      </Action>

      <!-- Wait for "Password:" Prompt -->
	  <Action name="TelnetListenPass" type="input" publisher="TcpHandler">
	    <DataModel ref="DataModels:TelnetPassPrompt" />
	  </Action>
	  
	  <!-- Telnet Send Password Value -->
      <Action name="TelnetSendPassword" type="output" publisher="TcpHandler">
        <DataModel ref="DataModels:TelnetPassword" />
      </Action>

      <!-- Wait for ":~$" Prompt -->
	  <Action name="TelnetListenCmd" type="input" publisher="TcpHandler">
	    <DataModel ref="DataModels:TelnetCmdPrompt" />
	  </Action>

	  <!-- Telnet Send Command Value -->
      <Action name="TelnetSend" type="output" publisher="TcpHandler">
        <DataModel ref="DataModels:TelnetCommand" />
      </Action>

		</State>
  </StateModel>
</Peach>
<!--END-->