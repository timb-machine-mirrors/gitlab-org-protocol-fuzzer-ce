<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://peachfuzzer.com/2012/Peach ../peach.xsd"  
       author="Deja Vu Security, LLC" description="File Transfer Protocol PIT DataModels" version="0.0.2">
	<!-- Copyright (c) Deja Vu Security, LLC 2013 -->
	
	<!-- Helper Models -->
	<DataModel name="ArgBlock">
		<String name="Break" token="true" value=" "/>
		<String name="Argument"/>
	</DataModel>

	<DataModel name="OneLineExplain">
		<String name="Break" token="true" value=" "/>
		<String name="Explaination"/>
		<String name="Terminator" token="true" value="\r\n"/>
	</DataModel>

	<DataModel name="MultiLineExplain">
		<String name="Break" token="true" value="-"/>
		<Block name="ExplainLineBlock">
			<String name="Explaination"/>
			<String name="Terminator" token="true" value="\r\n"/>
		</Block>
		<String name="LastLineMarker" token="true">
			<Fixup class="CopyValue">
				<Param name="ref" value="Status"/>
			</Fixup>
		</String>
		<String name="ExplainationLastLine"/>
		<String name="Terminator" token="true" value="\r\n"/>
	</DataModel>

	<DataModel name="MultiLineExplainV2">
		<Block name="FirstLine" ref="OneLineExplain">
			<String name="Break" token="true" value="-"/>
		</Block>
		<Block name="ExplainLineBlock" minOccurs="0">
			<String name="ContinuationMarker" length="3" >
				<Fixup class="CopyValue">
					<Param name="ref" value="Status"/>
				</Fixup>
			</String>
			<Block name="ContiuationLines" ref="OneLineExplain">
				<String name="Break" token="true" value="-"/>
			</Block>
		</Block>
		<String name="LastLineMarker" length="3">
			<Fixup class="CopyValue">
				<Param name="ref" value="Status"/>
			</Fixup>
		</String>
		<Block name="LastLine" ref="OneLineExplain"/>
	</DataModel>

	<!-- FTP Server Replies -->
	<DataModel name="ResponseTemplate">
		<String name="Status" length="3"/>
		<Choice name="LineModes">
			<Block name="OneLine" ref="OneLineExplain"/>
			<!-- <Block name="MultiLine" ref="MultiLineExplain"/> -->
			<Block name="MultiLine2" ref="MultiLineExplainV2"/>
		</Choice>
	</DataModel>
	
	<!-- 4.2.  FTP REPLIES -->
	<DataModel name="ServerOk" ref="ResponseTemplate">
		<String name="Status" value="200" token="true"/>
	</DataModel>

	<DataModel name="ServerReadyForUser" ref="ResponseTemplate">
		<String name="Status" value="220" token="true"/>
	</DataModel>

	<DataModel name="ServerUserNeedsPass" ref="ResponseTemplate">
		<String name="Status" value="331" token="true"/>
	</DataModel>

	<DataModel name="ServerLoggedIn" ref="ResponseTemplate">
		<String name="Status" value="230" token="true"/>
	</DataModel>

	<DataModel name="ServerQuit" ref="ResponseTemplate">
		<String name="Status" value="221" token="true"/>
	</DataModel>

	<!-- FTP Client Commands -->
	<DataModel name="RequestTemplate">
		<String name="Command" length="4"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="0"/>
		<String name="Terminator" length="2" mutable="false" token="true" value="\r\n"/>
	</DataModel>

	<!-- 4.1.  FTP COMMANDS -->
	
	<!--      USER <SP> <username> <CRLF> -->
	<DataModel name="USER" ref="RequestTemplate">
		<String name="Command" value="USER" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock">
			<String name="Argument" value="##FtpUser##"/>
		</Block>
	</DataModel>

  <!--      PASS <SP> <password> <CRLF> -->
	<DataModel name="PASS" ref="RequestTemplate">
		<String name="Command" value="PASS" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock">
			<String name="Argument" value="##FtpPass##"/>
		</Block>
	</DataModel>

  <!--      ACCT <SP> <account information> <CRLF> -->
	<DataModel name="ACCT" ref="RequestTemplate">
		<String name="Command" value="ACCT" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      REIN <CRLF> -->
	<DataModel name="REIN" ref="RequestTemplate">
		<String name="Command" value="REIN" token="true"/>
	</DataModel>

  <!--      QUIT <CRLF> -->
	<DataModel name="QUIT" ref="RequestTemplate">
		<String name="Command" value="QUIT" token="true"/>
	</DataModel>

  <!--      PORT <SP> <Host-port> <CRLF> -->
	<DataModel name="PORT" ref="RequestTemplate">
		<String name="Command" value="PORT" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      PASV <CRLF> -->
	<DataModel name="PASV" ref="RequestTemplate">
		<String name="Command" value="PASV" token="true"/>
	</DataModel>

  <!--      TYPE <SP> <type code> <CRLF> -->
	<DataModel name="TYPE" ref="RequestTemplate">
		<String name="Command" value="TYPE" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      STRU <SP> <structure code> <CRLF> -->
	<DataModel name="STRU" ref="RequestTemplate">
		<String name="Command" value="STRU" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      MODE <SP> <mode code> <CRLF> -->
	<DataModel name="MODE" ref="RequestTemplate">
		<String name="Command" value="MODE" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      RETR <SP> <pathname> <CRLF> -->
	<DataModel name="RETR" ref="RequestTemplate">
		<String name="Command" value="RETR" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      STOR <SP> <pathname> <CRLF> -->
	<DataModel name="STOR" ref="RequestTemplate">
		<String name="Command" value="STOR" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      APPE <SP> <pathname> <CRLF> -->
	<DataModel name="APPE" ref="RequestTemplate">
		<String name="Command" value="APPE" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      MLFL [<SP> <ident>] <CRLF> -->
	<DataModel name="MLFL" ref="RequestTemplate">
		<String name="Command" value="MLFL" token="true"/>
	</DataModel>

  <!--      MAIL [<SP> <ident>] <CRLF> -->
	<DataModel name="MAIL" ref="RequestTemplate">
		<String name="Command" value="MAIL" token="true"/>
	</DataModel>

  <!--      MSND [<SP> <ident>] <CRLF> -->
	<DataModel name="MSND" ref="RequestTemplate">
		<String name="Command" value="MSND" token="true"/>
	</DataModel>

  <!--      MSOM [<SP> <ident>] <CRLF> -->
	<DataModel name="MSOM" ref="RequestTemplate">
		<String name="Command" value="MSOM" token="true"/>
	</DataModel>

  <!--      MSAM [<SP> <ident>] <CRLF> -->
	<DataModel name="MSAM" ref="RequestTemplate">
		<String name="Command" value="MSAM" token="true"/>
	</DataModel>

  <!--      MRSQ [<SP> <scheme>] <CRLF> -->
	<DataModel name="MRSQ" ref="RequestTemplate">
		<String name="Command" value="MRSQ" token="true"/>
	</DataModel>

  <!--      MRCP <SP> <ident> <CRLF> -->
	<DataModel name="MRCP" ref="RequestTemplate">
		<String name="Command" value="MRCP" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      ALLO <SP> <decimal integer> -->
  <!--          [<SP> R <SP> <decimal integer>] <CRLF> -->
	<DataModel name="ALLO" ref="RequestTemplate">
		<String name="Command" value="ALLO" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      REST <SP> <marker> <CRLF> -->
	<DataModel name="REST" ref="RequestTemplate">
		<String name="Command" value="REST" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      RNFR <SP> <pathname> <CRLF> -->
	<DataModel name="RNFR" ref="RequestTemplate">
		<String name="Command" value="RNFR" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      RNTO <SP> <pathname> <CRLF> -->
	<DataModel name="RNTO" ref="RequestTemplate">
		<String name="Command" value="RNTO" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      ABOR <CRLF> -->
	<DataModel name="ABOR" ref="RequestTemplate">
		<String name="Command" value="ABOR" token="true"/>
	</DataModel>

  <!--      DELE <SP> <pathname> <CRLF> -->
	<DataModel name="DELE" ref="RequestTemplate">
		<String name="Command" value="DELE" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      CWD <SP> <pathname> <CRLF> -->
	<DataModel name="CWD" ref="RequestTemplate">
		<String name="Command" value="CWD" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      LIST [<SP> <pathname>] <CRLF> -->
	<DataModel name="LIST" ref="RequestTemplate">
		<String name="Command" value="LIST" token="true"/>
	</DataModel>

  <!--      NLST [<SP> <pathname>] <CRLF> -->
	<DataModel name="NLST" ref="RequestTemplate">
		<String name="Command" value="NLST" token="true"/>
	</DataModel>

  <!--      SITE <SP> <string> <CRLF> -->
	<DataModel name="SITE" ref="RequestTemplate">
		<String name="Command" value="SITE" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock" minOccurs="1"/>
	</DataModel>

  <!--      STAT [<SP> <pathname>] <CRLF> -->
	<DataModel name="STAT" ref="RequestTemplate">
		<String name="Command" value="STAT" token="true"/>
	</DataModel>

  <!--      HELP [<SP> <string>] <CRLF> -->
	<DataModel name="HELP" ref="RequestTemplate">
		<String name="Command" value="HELP" token="true"/>
	</DataModel>

  <!--      NOOP <CRLF> -->
	<DataModel name="NOOP" ref="RequestTemplate">
		<String name="Command" value="NOOP" token="true"/>
	</DataModel>

  <!--      CDUP - Change to Parent Directory -->
	<DataModel name="CDUP" ref="RequestTemplate">
		<String name="Command" value="CDUP" token="true"/>
	</DataModel>

  <!--      SMNT - Structure Mount -->
	<DataModel name="SMNT" ref="RequestTemplate">
		<String name="Command" value="SMNT" token="true"/>
	</DataModel>

  <!--      STOU - Store Unique -->
	<DataModel name="STOU" ref="RequestTemplate">
		<String name="Command" value="STOU" token="true"/>
	</DataModel>

  <!--      RMD - Remove Directory -->
	<DataModel name="RMD" ref="RequestTemplate">
		<String name="Command" value="RMD" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock">
			<String name="Argument" value="foobarbaz"/>
		</Block>
	</DataModel>

  <!--      MKD - Make Directory -->
	<DataModel name="MKD" ref="RequestTemplate">
		<String name="Command" value="MKD" token="true"/>
		<Block name="ReqArgBlock" ref="ArgBlock">
			<String name="Argument" value="foobarbaz"/>
		</Block>
	</DataModel>

  <!--      PWD - Print Directory -->
	<DataModel name="PWD" ref="RequestTemplate">
		<String name="Command" value="PWD" token="true"/>
	</DataModel>

  <!--      SYST - System -->
	<DataModel name="SYST" ref="RequestTemplate">
		<String name="Command" value="SYST" token="true"/>
	</DataModel>

	<!-- 4.1.  FTP COMMANDS -->
	<DataModel name="Request">
		<Choice>
			<Block name="QUITChoice" ref="QUIT" />
			<Block name="LISTChoice" ref="LIST" />
			<Block name="CWDChoice" ref="CWD" />
			<Block name="USERChoice" ref="USER" />
			<Block name="PASSChoice" ref="PASS" />
			<Block name="ACCTChoice" ref="ACCT" />
			<Block name="REINChoice" ref="REIN" />
			<Block name="PORTChoice" ref="PORT" />
			<Block name="PASVChoice" ref="PASV" />
			<Block name="TYPEChoice" ref="TYPE" />
			<Block name="STRUChoice" ref="STRU" />
			<Block name="MODEChoice" ref="MODE" />
			<Block name="RETRChoice" ref="RETR" />
			<Block name="STORChoice" ref="STOR" />
			<Block name="APPEChoice" ref="APPE" />
			<Block name="MLFLChoice" ref="MLFL" />
			<Block name="MAILChoice" ref="MAIL" />
			<Block name="MSNDChoice" ref="MSND" />
			<Block name="MSOMChoice" ref="MSOM" />
			<Block name="MSAMChoice" ref="MSAM" />
			<Block name="MRSQChoice" ref="MRSQ" />
			<Block name="MRCPChoice" ref="MRCP" />
			<Block name="ALLOChoice" ref="ALLO" />
			<Block name="RESTChoice" ref="REST" />
			<Block name="RNFRChoice" ref="RNFR" />
			<Block name="RNTOChoice" ref="RNTO" />
			<Block name="ABORChoice" ref="ABOR" />
			<Block name="DELEChoice" ref="DELE" />
			<Block name="NLSTChoice" ref="NLST" />
			<Block name="SITEChoice" ref="SITE" />
			<Block name="STATChoice" ref="STAT" />
			<Block name="HELPChoice" ref="HELP" />
			<Block name="NOOPChoice" ref="NOOP" />
			<Block name="CDUPChoice" ref="CDUP" />
			<Block name="SMNTChoice" ref="SMNT" />
			<Block name="STOUChoice" ref="STOU" />
			<Block name="RMDChoice" ref="RMD" />
			<Block name="MKDChoice" ref="MKD" />
			<Block name="PWDChoice" ref="PWD" />
			<Block name="SYSTChoice" ref="SYST" />
		</Choice>
	</DataModel>


	<!-- 3.4.  TRANSMISSION MODES -->
	<!-- 3.4.1.  STREAM MODE -->
	<!-- 3.4.2.  BLOCK MODE -->
	<!-- 3.4.3.  COMPRESSED MODE  -->
</Peach>
<!--END-->