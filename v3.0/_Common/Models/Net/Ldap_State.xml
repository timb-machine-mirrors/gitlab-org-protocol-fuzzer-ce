<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"  
       author="Deja Vu Security, LLC" description="LDAPv3 Pit StateModels" version="0.0.2">
	<!-- Copyright (c) Deja Vu Security, LLC 2013 -->
		
	<Include ns="DataModels" src="file:##Path##/_Common/Models/Net/Ldap_Data.xml"/>
	
	<StateModel name="Search" initialState="Initial">
		<State name="Initial">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Bind" />
       </Action>
			<Action type="changeState" ref="ldap" />
		</State>
		<State name="ldap">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Search" />
			</Action>
			<Action type="changeState" ref="ubind" />
		</State>
		<State name="ubind">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Unbind" />
			</Action>
		</State>
	</StateModel>
	
	<StateModel name="Add" initialState="Initial">
		<State name="Initial">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Bind" />
      </Action>
			<Action type="changeState" ref="ldap" />
		</State>
		<State name="ldap">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Add" />
			</Action>
			<Action type="changeState" ref="ubind" />
		</State>
		<State name="ubind">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Unbind" />
			</Action>
		</State>
	</StateModel>
	
	<StateModel name="Compare" initialState="Initial">
		<State name="Initial">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Bind" />
      </Action>
			<Action type="changeState" ref="ldap" />
		</State>
		<State name="ldap">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Compare" />
			</Action>
			<Action type="changeState" ref="ubind" />
		</State>
		<State name="ubind">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Unbind" />
			</Action>
		</State>
	</StateModel>
	
	<StateModel name="Delete" initialState="Initial">
		<State name="Initial">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Bind" />
            </Action>
			<Action type="changeState" ref="ldap" />
		</State>
		<State name="ldap">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Delete" />
			</Action>
			<Action type="changeState" ref="ubind" />
		</State>
		<State name="ubind">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Unbind" />
			</Action>
		</State>
	</StateModel>
	
	<StateModel name="ExtendOp" initialState="Initial">
		<State name="Initial">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Bind" />
            </Action>
			<Action type="changeState" ref="ldap" />
		</State>
		<State name="ldap">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:ExtendOp" />
			</Action>
			<Action type="changeState" ref="ubind" />
		</State>
		<State name="ubind">
			<Action type="output" publisher="tcp">
				<DataModel ref="DataModels:Unbind" />
			</Action>
		</State>
	</StateModel>
</Peach>
<!--END-->