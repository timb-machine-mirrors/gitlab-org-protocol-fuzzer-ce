<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"  
        author="Deja Vu Security, LLC" description="802.3 Ethernet PIT with 802.1Q support DataModels" version="0.0.2">
  <!-- Copyright (c) Deja Vu Security, LLC 2013 -->

  <DataModel name="VlanFrame">
    <Blob name="MACDest" length="6" valueType="hex" value="00 50 56 F1 C1 53"/>
    <Blob name="MACSrc" length="6" valueType="hex" value="00 0C 29 A3 9C B8"/>
    <Block name="802_1Q_Tag">
      <Number name="TPID" size="16" endian="big" value="8100"/>
      <Flags size="16" endian="big">
        <Flag name="Priority" size="3" position="0" valueType="hex" value="00"/>
        <Flag name="CFI" size="1" position="3" valueType="hex" value="00"/>
        <Flag name="VID" size="12" position="4" valueType="hex" value="0020"/>
      </Flags>
    </Block>
    <Number name="Ethertype" size="16" endian="big" valueType="hex" value="0800"/>
    <Blob name="Payload" valueType="hex" />
    <Number name="CRC" size="32" endian="big">
      <Fixup class="checksums.Crc32Fixup">
        <Param name="ref" value="Frame"/>
      </Fixup>
    </Number>
    <Blob name="Interframe" length="12" valueType="hex"/>
  </DataModel>

  <DataModel name="Frame">
    <Blob name="Dest" valueType="hex" mutable="false" length="6" value="##TargetMAC##"/>
    <Blob name="Src" valueType="hex" mutable="false" length="6" value="##SourceMAC##"/>
    <!-- IEEE 802.3 Section 3.2.6 Length/Type field -->
    <!-- More information can also be found at https://en.wikipedia.org/wiki/EtherType -->
    <Number name="TypeOrLen" size="16" token="true"  endian="big" mutable="false">
      <!-- "a) If the value of this field is less than or equal to 1500 decimal (05DC hexadecimal), then the Length/ -->
      <!-- Type field indicates the number of MAC client data octets contained in the subsequent MAC Client -->
      <!-- Data field of the basic frame (Length interpretation). -->
      <!-- b) If the value of this field is greater than or equal to 1536 decimal (0600 hexadecimal), then the -->
      <!-- Length/Type field indicates the nature of the MAC client protocol (Type interpretation).19 -->
      <!-- The Length and Type interpretations of this field are mutually exclusive." -->

      <!-- <Relation type="size" of="Payload"/> -->
      <!-- !!FIXME!! Parents of relations cannot be overriden. This will be fixed when that is fixed. -->
    </Number>
    <Block name="Payload"/>
  </DataModel>
</Peach>
<!--End-->
