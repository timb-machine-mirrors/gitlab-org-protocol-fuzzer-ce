<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"  
       author="Deja Vu Security, LLC" description="Adress Resolution Protocol PIT" version="0.0.2">
  <!-- Copyright (c) Deja Vu Security, LLC 2013 -->

  <DataModel name="ARP">
    <Block name="EtherHeader">
      <Blob name="Dest" valueType="hex" value="ffffffffffff"/>
      <Blob name="Src" valueType="hex" value="##SourceMAC##"/>
      <Blob name="Type" token="true" valueType="hex" value="0806"/>
    </Block>
		
    <Block name="ARPPayload">
      <Number name="HTYPE" size="16" value="01" endian="big" signed="true"/><!--Set PTYPE to a choice which is filled out with a DataObject based on what type of Address it is Also changed teh defines from IPv4 to a more generic one.-->
      <Number name="PTYPE" size="16" endian="big" signed="true" value="0x0800"/>
      <Number name="HLEN" size="8" >
				<Relation type="size" of="SHA"/>	
      </Number>
      <Number name="PLEN" size="8" >
				<Relation type="size" of="SPA"/> 
      </Number>
      <Number name="OPER" size="16" endian="big" value="1"/>
      <Blob name="SHA" valueType="hex" value="##SourceMAC##"/>
      <Blob name="SPA" value="##SourceIPv4##">
				<Transformer class="Ipv4StringToNetworkOctet"/>
      </Blob>
      <Blob name="THA" valueType="hex" value="##TargetMAC##"/>
      <Blob name="TPA" value="##TargetIPv4##">
				<Transformer class="Ipv4StringToNetworkOctet"/>
      </Blob>
    </Block>
    <Blob name="Trailer"/>
  </DataModel>
</Peach>
<!--End-->