<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
			 xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"
			 author="Deja Vu Security, LLC" description="Adress Resolution Protocol PIT" version="0.0.2">
	<!-- Copyright (c) Deja Vu Security, LLC 2013 -->

	<Include ns="Ethernet" src="file:##Path##/_Common/Models/Net/Ethernet_Data.xml"/>
	<Include ns="ARP" src="file:##Path##/_Common/Models/Net/ARP_Data.xml"/>

	<DataModel name="ARPPacket" ref="Ethernet:Frame">
		<Number name="TypeOrLen" token="true" valueType="hex" size="16" value="0806"/>
		<Block name="Payload" ref="ARP:Packet" />
	</DataModel>

	<StateModel name="Request" initialState="Initial">
		<State name="Initial">
			<Action type="output">
				<DataModel ref="ARPPacket"/>
				<Data name="ARPRequest">
					<Field name="Dest" valueType="hex" mutable="false" value="ffffffffffff"/>
					<Field name="Payload.Data.OPER.Request" value=""/>
				</Data>
			</Action>
		</State>
	</StateModel>

	<StateModel name="Reply" initialState="Initial">
		<State name="Initial">
			<Action name="GetRequest" type="input">
				<DataModel ref="ARPPacket"/>
			</Action>
			<Action type="slurp" valueXpath="//GetRequest//ARPPacket/Payload/Data/TPABlock/TPA" setXpath="//DoReply//SPA"/>
			<Action type="slurp" valueXpath="//GetRequest//SPA" setXpath="//DoReply//TPA"/>
			<Action type="slurp" valueXpath="//GetRequest//ARPPacket/Src" setXpath="//DoReply//Dest"/>
			<Action type="slurp" valueXpath="//GetRequest//ARPPacket/Src" setXpath="//DoReply//THA"/>
			<Action name="DoReply" type="output">
				<DataModel ref="ARPPacket"/>
				<Data name="ARPReply">
					<Field name="Payload.Data.OPER.Reply" value=""/>
				</Data>
			</Action>
		</State>
	</StateModel>

</Peach>
<!--End-->
