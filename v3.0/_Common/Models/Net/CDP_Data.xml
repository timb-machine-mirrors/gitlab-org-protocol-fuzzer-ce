<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
			 xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"
			 author="Deja Vu Security, LLC" description="Cisco Discovery Protocol PIT DataModels" version="0.0.2">
	<!-- Copyright (c) Deja Vu Security, LLC 2013 -->

	<!-- Cisco Discovery Protocol Main DataModel -->
	<DataModel name="Packet">
		<Number name="Version" size="8" value="2"/>
		<Number name="Ttl" size="8" value="120"/>
		<Number name="Checksum" size="16" endian="big" mutable="false" value="0x0000">
			<!-- This checksum, according to Cisco documentation, is a
					 standard IP checksum
					 (http://www.faqs.org/rfcs/rfc1071.html). The
					 documentation is incorrect. For odd bytes lengths
					 padding is incorrect. -->
			<Fixup class="CiscoFixup">
				<Param name="ref" value="Packet"/>
			</Fixup>
		</Number>
		<Block name="DeviceIdTlv" >
			<Number name="DeviceIdTlvType" size="16" endian="big" value="1"/>
			<Number name="DeviceIdTlvLength" size="16" endian="big">
				<Relation type="size" of="DeviceIdTlv"/>
			</Number>
			<Blob name="DeviceIdTlvValue" value="##Hostname##"/>
		</Block>

		<Block name="AddressTlv" >
			<Number name="AddressTlvType" size="16" endian="big" value="2"/>
			<Number name="AddressTlvLength" size="16" endian="big">
				<Relation type="size" of="AddressTlv"/>
			</Number>
			<Number name="AddressCount" size="32" endian="big">
				<Relation type="count" of="AddressTlvValueBlock"/>
			</Number>
			<Block name="AddressTlvValueBlock" minOccurs="1">
				<Number name="AddressProtoType" value="1" size="8"/>
				<Number name="AddressProtoLength" size="8">
					<Relation type="size" of="AddressProto"/>
				</Number>
				<Number name="AddressProto" size="16"/>
				<Number name="AddressValueLength" size="8">
					<Relation type="size" of="AddressTlvValue"/>
				</Number>
				<Block name="AddressTlvValueBlock" length="4">
					<String name="AddressTlvValue" value="##SourceIPv4##">
						<Transformer class="Ipv4StringToOctet"/>
					</String>
				</Block>
			</Block>
		</Block>

		<Block name="PortTlv">
			<Number name="PortTlvType" size="16" endian="big" value="3"/>
			<Number name="PortTlvLength" size="16" endian="big">
				<Relation type="size" of="PortTlv"/>
			</Number>
			<Blob name="PortTlvValue" value="##Interface##"/>
		</Block>

		<Block name="CapabilitesTlv">
			<Number name="CapabilitesTlvType" size="16" endian="big" value="4"/>
			<Number name="CapabilitesTlvLength" size="16" endian="big">
				<Relation type="size" of="CapabilitesTlv"/>
			</Number>
			<Blob name="CapabilitesTlvValue" length="4" valueType="hex" value="00000018"/>
		</Block>

		<Block name="SoftwareVersionTlv">
			<Number name="SoftwareVersionTlvType" size="16" endian="big" value="5"/>
			<Number name="SoftwareVersionTlvLength" size="16" endian="big">
				<Relation type="size" of="SoftwareVersionTlv"/>
			</Number>
			<Blob name="SoftwareVersionTlvValue" value="test"/>
		</Block>

		<Block name="PlatformTlv">
			<Number name="PlatformTlvType" size="16" endian="big" value="6"/>
			<Number name="PlatformTlvLength" size="16" endian="big">
				<Relation type="size" of="PlatformTlv"/>
			</Number>
			<Blob name="PlatformTlvValue" value="linux"/>
		</Block>

		<Block name="ArbitraryTlv" minOccurs="0" maxOccurs="50">
			<Number name="ArbitraryTlvType" size="16" endian="big"/>
			<Number name="ArbitraryTlvLength" size="16" endian="big">
				<Relation type="size" of="ArbitraryTlv"/>
			</Number>
			<Blob name="ArbitraryTlvValue"/>
		</Block>
</DataModel>
</Peach>
<!--End-->
