<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"  
       author="Deja Vu Security, LLC" description="Avi Divx PIT DataModels" version="0.0.2">
  <!-- Copyright (c) Deja Vu Security, LLC 2013 -->
	
	<DataModel name="Chunk">
		<String name="ID" length="4" padCharacter=" " />
		<Number name="Size" size="32" signed="false">
			<Relation type="size" of="Data"/>
		</Number>
		<Blob name="Data"/>
		<Padding aligned="true" alignment="8" />
	</DataModel>
	
	<DataModel name="AVI">
		<Block name="AviHeader" ref="Chunk">
			<String name="ID" value="RIFF" token="true" />
			<Block name="Data">
				<String name="Type" value="AVI " token="true"/>
				
				<Choice name="ChunkChoice" maxOccurs="30000">
<!-- LIST -->		<Block name="Data">
						<Choice name="ChunkChoice" maxOccurs="-1">
							<Block name="ChunkList-head" ref="Chunk">
								<String name="ID" value="LIST" token="true" />
								<Block name="Data">
									<Choice name="TypeChoice" maxOccurs="4">
			<!--hdrl-->
										<Block name="hdrl-head">
											<String name="ID" value="hdrl" token="true" />
											<Block name="Data">
												<Block name="avih">
													<String name="ID" value="avih" length="4" token="true" />
													<Number name="Size" size="32" signed="false">
														<Relation type="size" of="Data"/>
													</Number>
													<Blob name="Data"/>
													<Padding aligned="true" alignment="16" />
												</Block>
											</Block>
										</Block>
										<Block name="hdrl-list">
												<Block name="LIST" ref="Chunk"> 
													<String name="ID" value="LIST" token="true" />
													<Block name="Data">
															<String name="ID" value="strl" length="4" token="true" />
															<Block name="Data">
																<Choice maxOccurs="2">
																	<Block name="strh" >
																		<String name="ID" value="strh" length="4" token="true" />
																		<Number name="Size" size="32" signed="false">
																			<Relation type="size" of="Data"/>
																		</Number>
																		<Blob name="Data"/>
																		<Padding aligned="true" alignment="16" />
																	</Block>
																	<Block name="strf" >
																		<String name="ID" value="strf" length="4" token="true" />
																		<Number name="Size" size="32" signed="false">
																			<Relation type="size" of="Data"/>
																		</Number>
																		<Blob name="Data"/>
																		<Padding aligned="true" alignment="16" />
																	</Block>
																</Choice>
															</Block>
													</Block>
												</Block>
										</Block>
									</Choice>
								</Block>
							</Block>
		<!--INFO-->
							<Block name="ChunkList-info" >
								<String name="ID" value="LIST" token="true" />
								<Number name="Size" size="32" signed="false">
									<Relation type="size" of="Data"/>
								</Number>
								<Block name="Data">
									<Block name="INFO" >
										<String name="ID" value="INFO" token="true" />
										<Block name="Data">
											<Choice maxOccurs="30000" >
												<Block name="SubChunk" >
													<String name="ID" length="4" />
													<Number name="Size" size="32" signed="false">
														<Relation type="size" of="Data"/>
													</Number>
													<String name="Data" nullTerminated="true"/>
													<Padding aligned="true" alignment="8" />
												</Block>
											</Choice>
										</Block>
									</Block>
								</Block>
							</Block>
							<Block name="JUNQ" ref="Chunk">
								<String name="ID" value="JUNQ" token="true" />
							</Block>
							<Block name="JUNK" ref="Chunk">
								<String name="ID" value="JUNK" token="true" />
							</Block>
		<!--movi-->
							<Block name="ChunkList-movi" ref="Chunk">
								<String name="ID" value="LIST" token="true" length="4" />
								<Block name="Data">
									<String name="ID" value="movi" token="true" length="4" />
									<Choice name="movie" maxOccurs="-1">
										<Block name="movie-data">
											<String name="ID" length="4" />
											<Number name="Size" size="32" signed="false">
												<Relation type="size" of="Data"/>
											</Number>
											<Blob name="Data" />
											<Padding aligned="true" alignment="16" alignedTo="movie-data"/>
										</Block>
									</Choice>
								</Block>
							</Block>
		<!-- idx1 -->
							<Block name="idx1" ref="Chunk">
								<String name="ID" value="idx1" token="true" />
								<Block name="Data">
									<Choice name="index" maxOccurs="-1">
										<Block>
											<String name="Tag" length="4" />
											<String name="Flags" length="4" />
											<Number name="TagPosition" size="32" />
											<Number name="TagLength" size="32" />
										</Block>
									</Choice>
								</Block>
							</Block>
							<Block name="Unknown" ref="Chunk" />
						</Choice>
					</Block>
				</Choice>
			</Block>
		</Block>
	</DataModel>
</Peach>
<!--END-->