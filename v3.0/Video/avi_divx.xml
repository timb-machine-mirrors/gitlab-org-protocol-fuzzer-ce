<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"  
       author="Deja Vu Security, LLC" description="Avi Divx PIT" version="0.0.2">
  <!-- Copyright (c) Deja Vu Security, LLC 2013 -->
	
	<Include ns="AviDivx" src="file:##Path##/_Common/Models/Video/avi_divx_State.xml"/>
	
	<Agent name="Linux">
		<Monitor class="LinuxCrashMonitor"/>
		
		<Monitor class="Process">
			<Param name="Executable" value="##Target##"/>
			<Param name="StartOnCall" value="LaunchMplayer"/>
			<Param name="Arguments" value="fuzzed.avi"/>
			<Param name="CpuKill" value="true"/>
		</Monitor>
	</Agent>

	<Agent name="OSX">
		<Monitor class="CrashWrangler">
			<Param name="Command" value="##Target##"/>
			<Param name="Arguments" value="fuzzed.avi"/>
			<Param name="StartOnCall" value="LaunchMplayer"/>
		</Monitor>
	</Agent>

	<Agent name="Win">
		<Monitor class="PageHeap">
      <Param name="Executable" value="vlc.exe"/>
    </Monitor>


		<Monitor class="WindowsDebugger">
			<Param name="CommandLine" value="##Target## fuzzed.avi"/>
			<Param name="StartOnCall" value="LaunchMplayer"/>
			<Param name="CpuKill" value="true"/>
		</Monitor>
	</Agent>

	<Test name="Default">
		<StateModel ref="AviDivx:MplayerTest"/>

		<Agent ref="##Agent##"/>

		<Publisher class="File">
			<Param name="FileName" value="fuzzed.avi"/>
		</Publisher>

		<Strategy class="##Strategy##"/>

		<Logger class="File">
			<Param name="Path" value="##LoggerPath##"/>
		</Logger>
	</Test>
</Peach>
<!-- end -->
