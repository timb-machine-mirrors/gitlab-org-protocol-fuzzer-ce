<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://peachfuzzer.com/2012/Peach ../peach.xsd"
       author="Deja Vu Security, LLC" description="Simple Network Management Protocol PIT" version="0.0.2">
  <!-- Copyright (c) Deja Vu Security, LLC 2013 -->

  <!--
      Simple Network Management Protocol v2c
  -->

	<Include ns="SNMP" src="file:##Path##/_Common/Models/Net/SNMP_State.xml"/>

  <Agent name="Agent">
  </Agent>

	<Agent name="Windows">
    <Monitor class="Process">
      <Param name="Executable" value="##Program##" />
      <Param name="Arguments" value="-r:##SourceIPv4## -c: ##CommString## -v:2c ##SourceIPv4##"/>
      <Param name="FaultOnEarlyExit" value="true"/>
      <Param name="StartOnCall" value="launchProgram"/>
      <Param name="WaitForExitOnCall" value="exitProgram"/>
    </Monitor>
	</Agent>

  <Agent name="Linux">
     <Monitor class="LinuxCrashMonitor"/>

    <Monitor class="Process">
      <Param name="Executable" value="##Program##" />
      <Param name="Arguments" value="-c ##CommString## -v2c ##SourceIPv4##"/>
      <Param name="StartOnCall" value="launchProgram" />
      <Param name="FaultOnEarlyExit" value="true"/>
      <Param name="WaitForExitOnCall" value="exitProgram"/>
    </Monitor>
  </Agent>

  <Agent name="OSX">
    <Monitor class="Process">
      <Param name="Executable" value="##Program##" />
      <Param name="Arguments" value="-c ##CommString## -v2c ##SourceIPv4##"/>
      <Param name="StartOnCall" value="launchProgram" />
      <Param name="FaultOnEarlyExit" value="true"/>
      <Param name="WaitForExitOnCall" value="exitProgram"/>
    </Monitor>
  </Agent>

  <!-- Default test case -->
  <Test name="Default">
    <StateModel ref="SNMP:ManagerToAgent"/>

    <Agent ref="Agent"/>

    <Publisher class="Udp" name="UdpHandler">
      <Param name="SrcPort" value="##SourcePort##"/>
      <Param name="Host" value="##TargetIPv4##"/>
      <Param name="Port" value="##TargetPort##"/>
    </Publisher>

    <Strategy class="##Strategy##"/>

    <Logger class="File">
      <Param name="Path" value="##LoggerPath##"/>
    </Logger>
  </Test>

	<Test name="Server">
    <StateModel ref="SNMP:AgentToManager"/>

   <Agent ref="##Agent##"/>

    <Publisher class="Udp" name="UdpHandler">
      <Param name="SrcPort" value="##SourcePort##"/>
      <Param name="Host" value="##SourceIPv4##"/>
			<Param name="Timeout" value="5000"/>
    </Publisher>

    <Strategy class="##Strategy##"/>

    <Logger class="File">
      <Param name="Path" value="##LoggerPath##"/>
    </Logger>
  </Test>
</Peach>
<!--End-->

