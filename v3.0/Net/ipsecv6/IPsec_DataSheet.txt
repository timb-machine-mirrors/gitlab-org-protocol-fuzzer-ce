Protocol
--------

 * Test Suite: IPsec
 * Direction: Client
 
 Protocol suite for securing Internet Protocol (IP) communications
 by authenticating and encrypting each IP packet of a communication session.

Used Specifications
~~~~~~~~~~~~~~~~~~~

[options="header"]
|========
|Specification | Title
|RFC2403 | The Use of HMAC-MD5-96 within ESP and AH
|RFC2404 | The Use of HMAC-SHA-1-96 within ESP and AH
|RFC2405 | The ESP DES-CBC Cipher Algorithm With Explicit IV
|RFC2410 | The NULL Encryption Algorithm and Its Use With IPsec
|RFC2451 | The ESP CBC-Mode Cipher Algorithms
|RFC2857 | The Use of HMAC-RIPEMD-160-96 within ESP and AH
|RFC3526 | More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE) (Might not be relevant)
|RFC3947 | Negotiation of NAT-Traversal in the IKE
|RFC3948 | UDP Encapsulation of IPsec ESP Packets
|RFC4106 | The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)
|RFC4301 | Security Architecture for the Internet Protocol
|RFC4302 | IP Authentication Header
|RFC4303 | IP Encapsulating Security Payload
|RFC4304 | Extended Sequence Number (ESN) Addendum to IPsec Domain of Interpretation (DOI) for Internet Security Association and Key Management Protocol (ISAKMP)
|RFC4307 | Cryptographic Algorithms for Use in the Internet Key Exchange Version 2
|RFC4308 | Cryptographic Suites for IPsec
|RFC4309 | Using Advanced Encryption Standard (AES) CCM Mode with IPsec Encapsulating Security Payload (ESP)
|RFC4543 | The Use of Galois Message Authentication Code (GMAC) in IPsec ESP and AH
|RFC4555 | IKEv2 Mobility and Multihoming Protocol (MOBIKE)
|RFC4806 | Online Certificate Status Protocol (OCSP) Extensions to IKEv2
|RFC4835 | Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)
|RFC4945 | The Internet IP Security PKI Profile of IKEv1/ISAKMP, IKEv2, and PKIX
|RFC5996 | Internet Key Exchange Protocol Version 2 (IKEv2)
|========

Detailed Use Cases
~~~~~~~~~~~~~~~~~~

[options="header"]
|========
|Messages | Specification
|Encapsulating Security Payload Packet Format | RFC4303 2
|Authentication Header (AH) | RFC4302
|========

[options="header"]
|========
|Supported Features | Specification
|Transport Mode Processing | RFC4303 3.1.1
|Tunnel Mode Processing | RFC4303 3.1.2
|Separate Confidentiality and Integrity Algorithms | RFC4303 3.4.4.1
|ICV HMAC-MD5-96 | RFC2403
|ICV HMAC-SHA-1-96 | RFC2404
|ICV HMAC-RIPEMD-160-96 | RFC2857
|3DES-CBC Cipher Encryption | RFC2405, RFC2451 
|Null Encryption | RFC2410
|========

[options="header"]
|========
|Supported Payloads | Specification
|
|========

--Doesn't support anti-replay (reestablishing the SA when Sequence number will cycle |Sequence Number Generation | RFC4303 3.3.3, 3.4.3
--Doesn't support Fragmentation (Cracking) processing (fragmentation reassembly should probably be done by the publisher/might already be done by publisher)
--Doesn't support Fragmentented sending RFC4303 3.3.4-3.4.2
--Doesn't support randomly generated IV's
--Doesn't support ESP Encapsulated in UDP RFC3948 (Mainly used for IKE)
--Doesn't support the following Encryption Algs: CAST-128, RC5, IDEA, Blowfish. RFC2451
--Doesn't support IKE (RFC3947, RFC4555, RFC4307, RFC4806, RFC4835, RFC4945, RFC5996)
--Doesn't support Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP) RFC4106
--Doesn't support Extened Sequence Numbers (used with IKE) RFC4304
--Partial support for Crypto Suites (Missing all IKE) RFC4308
--Doesn't support AES CCM with ESP RFC4309
--Doesn't support AES GCM (GMAC) RFC4543
--Maybe supports |Combined Confidentiality and Integrity Algorithms | RFC4303 3.4.4.2