<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"  
       author="Deja Vu Security, LLC" description="Adress Resolution Protocol PIT" version="0.0.2">
  <!-- Copyright (c) Deja Vu Security, LLC 2013 -->
  <!-- Requires Linux Peach 3.0 and RawEther publisher -->
	
	<Include ns="ARP" src="file:##Path##/_Common/Models/Net/ARP_State.xml"/>
	
  <Agent name="RemoteAgent" location="tcp://##RemoteAgentIP##:9001">
    <Monitor class="Process">
      <Param name="Executable" value="##tsharkBin##"/>
      <Param name="Arguments" value="-i ##tsharkInterface##"/>
      <Param name="FaultOnEarlyExit" value="true"/>
    </Monitor>
		
    <Monitor class="Pcap">
      <Param name="Device" value="##Interface##"/>
    </Monitor>
  </Agent>

  <Agent name="LocalAgent">
    <Monitor class="Pcap">
      <Param name="Device" value="##Interface##"/>
    </Monitor>
  </Agent>

  <!-- Default test for fuzzing ARP -->
  <Test name="Default">
		<Exclude xpath="//ARPPacket"/>
		<Include xpath="//ARPPacket/Payload"/>
    <StateModel ref="ARP:Request"/>
		
    <!--Agent ref="RemoteAgent"/-->
    <!--Agent ref="LocalAgent"/-->
		
    <Publisher class="RawEther">
      <Param name="Interface" value="##Interface##"/>
      <Param name="Protocol" value="ETH_P_ARP"/>
    </Publisher>
    
    <Strategy class="##Strategy##"/>
		
    <Logger class="File">
      <Param name="Path" value="##LoggerPath##"/>
    </Logger>
  </Test>

  <Test name="Reply">
		<Exclude xpath="//ARPPacket"/>
		<Include xpath="//ARPPacket/Payload"/>
    <StateModel ref="ARP:Reply"/>
		
    <!--Agent ref="RemoteAgent"/-->
    <!--Agent ref="LocalAgent"/-->
		
    <Publisher class="RawEther">
      <Param name="Interface" value="##Interface##"/>
      <Param name="Protocol" value="ETH_P_ARP"/>
    </Publisher>
    
    <Strategy class="##Strategy##"/>
		
    <Logger class="File">
      <Param name="Path" value="##LoggerPath##"/>
    </Logger>
  </Test>


</Peach>
<!--End-->
