<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd">

  <DataModel name="Options">
    <Number name="CIdentifier" endian="network" size="16" />
    <Number name="CLength" endian="network" size="16">
      <Relation type="size" of="CValue"/>
    </Number>
    <Block name="CValue" />
  </DataModel>
	
  <DataModel name="DHCPv6">
    <Number name="type" size="8" value="1" />
    <Number name="TranID" size="24" valueType="hex" value="00 46 09" />
    <Choice minOccurs="0" maxOccurs="5">
      <Block name="ClientID" ref="Options" >
        <Number name="CIdentifier" size="16" endian="network" token="true" value="1"/>
        <Block name="CValue">
          <Number name="DuidType" size="16" valueType="hex" value="00 01"/>
          <Number name="HWType" size="16" valueType="hex" value="00 01"/>
          <Blob name="Address" valueType="hex" value="##SourceMAC##" />
        </Block>
      </Block>
      
      <Block name="ServerID" ref="Options" >
        <Number name="CIdentifier" size="16" endian="network" token="true" value="2"/>
        <Block name="CValue">
          <Number name="DuidType" size="16" valueType="hex" value="00 03"/>
          <Number name="HWType" size="16" valueType="hex" value="00 01"/>
          <Blob name="Time" valueType="hex" value="deadbeef" />
          <Blob name="Address" valueType="hex" value="##DestinationMAC##" />
        </Block>
      </Block>
			
      <Block name ="IAfNtA" ref="Options">
        <Number name="CIdentifier" size="16" endian="network" token="true" value="3"/>
        <Block name="CValue">
          <Blob valueType="hex" value="00 00 00 00 00 00 00 00 00 00 00 00"/>
        </Block>
      </Block>
      
      <Block name ="ElapsedTime" ref="Options">
        <Number name="CIdentifier" size="16" endian="network" token="true" value="8"/>
        <Block name="CValue">
          <Blob valueType="hex" value="00 00"/>
        </Block>
      </Block>
      
      <Block name ="OptionRequest" ref="Options">
        <Number name="CIdentifier" size="16" endian="network" token="true" value="6"/>
        <Block name="CValue">
          <Blob valueType="hex" value="00 03"/>
        </Block>
      </Block>
      
    </Choice>
  </DataModel>
	
  <DataModel name="DHCPv6standard">
    <Number name="type" size="8" value="1" />
    <Number name="TranID" size="24" valueType="hex" value="00 46 09" />
    <Block name="ClientID" ref="Options" >
      <Number name="CIdentifier" size="16" endian="network" value="1"/>
      <Block name="CValue">
        <Number name="DuidType" size="16" valueType="hex" value="00 03"/>
        <Number name="HWType" size="16" valueType="hex" value="00 01"/>
        <Blob name="Address" valueType="hex" value="##SourceMAC##" />
      </Block>
    </Block>
    <Block name ="IAfNtA" ref="Options">
      <Number name="CIdentifier" size="16" endian="network" value="3"/>
      <Block name="CValue">
        <Blob valueType="hex" value="00 00 00 00 00 00 00 00 00 00 00 00"/>
      </Block>
    </Block>
    <Block name ="ElapsedTime" ref="Options">
      <Number name="CIdentifier" size="16" endian="network" value="8"/>
      <Block name="CValue">
        <Blob valueType="hex" value="00 00"/>
      </Block>
    </Block>
    <Block name ="OptionRequest" ref="Options">
      <Number name="CIdentifier" size="16" endian="network" value="6"/>
      <Block name="CValue">
        <Blob valueType="hex" value="00 03"/>
      </Block>
    </Block>
  </DataModel>
  
  <StateModel name="TheState" initialState="Initial">
    <State name="Initial">
      <Action type="output">
        <DataModel ref="DHCPv6standard"/>
      </Action>
    </State>
  </StateModel>

  <!-- TODO: Configure Agent -->
  <Agent name="TheAgent">
  </Agent>
  
  <Test name="Default">
    <Agent ref="TheAgent"/>
    <StateModel ref="TheState"/>
    
    <Publisher class="Udp">
      <Param name="Host" value="##Target##"/>
      <Param name="Port" value="##TargetPort##"/>
      <Param name="SrcPort" value="##SourcePort##"/>
      <Param name="Interface" value="##Source##"/>
    </Publisher>

    <!--<Strategy class="Random"/>-->		
    <Logger class="File">
      <Param name="Path" value="##LoggerPath##"/>
    </Logger>
  </Test>

</Peach>
<!-- end -->
