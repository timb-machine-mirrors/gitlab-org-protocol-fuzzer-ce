<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
			 xsi:schemaLocation="http://peachfuzzer.com/2012/Peach ../peach.xsd"
			 author="Deja Vu Security, LLC" description="Common Headers test PIT" version="0.0.2">

	<Include ns="Ethernet" src="file:##Path##/CommonHeaders/EthernetHeader.xml"/>

	<Include ns="IPv4" src="file:##Path##/CommonHeaders/IPv4Header.xml"/>
	<Include ns="IPv6" src="file:##Path##/CommonHeaders/IPv6Header.xml"/>

	<Include ns="TCP" src="file:##Path##/CommonHeaders/TCPHeader.xml"/>
	<Include ns="UDP" src="file:##Path##/CommonHeaders/UDPHeader.xml"/>

	<!-- <Include ns="VLAN" src="file:##Path##/CommonHeaders/VLANHeader.xml"/> -->

	<DataModel name="FrameEtherIPv4TCP">
		<Block name="Ether" ref="Ethernet:EthernetHeader">
			<Number size="16" name="Type" valueType="hex" value="0800"/>
		</Block>
		<Block name="IP" ref="IPv4:IPv4Header">
			<Number name="Header.Protocol" size="8" endian="big" value="06"/>
			<Block name="IPv4Payload" ref="TCP:TCPHeader">
			</Block>
		</Block>
	</DataModel>

	<DataModel name="FrameEtherIPv4UDP">
		<Block name="Ether" ref="Ethernet:EthernetHeader">
			<Number size="16" name="Type" valueType="hex" value="0800"/>
		</Block>
		<Block name="IP" ref="IPv4:IPv4Header">
			<Number name="Header.Protocol" size="8" endian="big" value="17"/>
			<Block name="IPv4Payload" ref="UDP:UDPHeader">
				<Number name="SrcPort" size="16" endian="network" value="1234"/>
				<Number name="DestPort" size="16" endian="network" value="1234"/>
				<Block name="UdpPayload">
					<Blob value="AAAAAAAAAA"/>
				</Block>
			</Block>
		</Block>
	</DataModel>

	<DataModel name="FrameEtherIPv6TCP">
		<Block name="Ether" ref="Ethernet:EthernetHeader">
			<Number size="16" name="Type" valueType="hex" value="0800"/>
		</Block>
		<Block name="IP" ref="IPv6:IPv6Header">
			<Number name="NextHeader" size="8" endian="big" value="6"/>
			<Block name="IPv6Payload" ref="TCP:TCPHeader">
			</Block>
		</Block>
	</DataModel>

	<DataModel name="FrameEtherIPv6UDP">
		<Block name="Ether" ref="Ethernet:EthernetHeader">
			<Number size="16" name="Type" valueType="hex" value="0800"/>
		</Block>
		<Block name="IP" ref="IPv6:IPv6Header">
			<Number name="NextHeader" size="8" endian="big" value="17"/>
			<Block name="IPv6Payload" ref="UDP:UDPHeader">
				<Number name="SrcPort" size="16" endian="network" value="1234"/>
				<Number name="DestPort" size="16" endian="network" value="1234"/>
				<Number name="Checksum" size="16" endian="big">
					<Fixup class="UDPChecksumFixup">
						<Param name="ref" value="Header" />
						<Param name="src" value="##SourceIPv6##" />
						<Param name="dst" value="##TargetIPv6##" />
					</Fixup>
				</Number>
				<Block name="UdpPayload">
					<Blob value="AAAAAAAAAA"/>
				</Block>
			</Block>
		</Block>
	</DataModel>

  <StateModel name="State" initialState="Initial">
    <State name="Initial">
      <Action type="output">
				<DataModel ref="##Test##"/>
      </Action>
    </State>
  </StateModel>

  <Test name="Default">
    <StateModel ref="State"/>
    <Publisher class="RawEther">
      <Param name="Interface" value="##Interface##"/>
    </Publisher>
  </Test>


</Peach>
