<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"
        author="Deja Vu Security, LLC"
        description="BGP4 PIT"
        version="0.0.1">

    <!-- draft-ietf-idr-dynamic-cap-14 Dynamic Capabilities
         https://tools.ietf.org/html/draft-ietf-idr-dynamic-cap-14 -->

    <Include ns="Base" src="file:##Path##/_Common/Models/Net/BGP_BaseTypes.xml"/>
    <Include ns="rfc2918" src="file:##Path##/_Common/Models/Net/BGP_rfc2918.xml"/>
    <Include ns="rfc5291" src="file:##Path##/_Common/Models/Net/BGP_rfc5291.xml"/>
    <Include ns="rfc4724" src="file:##Path##/_Common/Models/Net/BGP_rfc4724.xml"/>
    <Include ns="rfc4760" src="file:##Path##/_Common/Models/Net/BGP_rfc4760.xml"/>
    <Include ns="rfc6793" src="file:##Path##/_Common/Models/Net/BGP_rfc6793.xml"/>

    <DataModel name="Capability" ref="Base:BGP4Capability">
        <Number name="CapabilityType"
                size="8" value="67" token="true"/>
        <Block name="CapabilityValue">
            <!-- Empty? -->
        </Block>
    </DataModel>

    <DataModel name="Message" ref="Base:BGP4Message">
        <Number name="MessageType" size="8" value="6" token="true"/>
        <Block name="MessageData">
            <Number name="InitAck" size="1"/>
            <Number name="AckRequest" size="1"/>
            <Number name="Reserved" size="5"/>
            <Number name="Action" size="1"/>
            <Number name="SequenceNo" size="32" endian="big"/>
            <Choice name="CapType">
                <Block name="MultiProtocol" ref="rfc4760:Capability">
                    <Number name="CapabilityLength" size="16" endian="big">
                        <Relation type="size" of="CapabilityValue"/>
                    </Number>
                </Block>
                <Block name="RouteRefresh" ref="rfc2918:Capability">
                    <Number name="CapabilityLength" size="16" endian="big">
                        <Relation type="size" of="CapabilityValue"/>
                    </Number>
                </Block>
                <Block name="OutboundRouteFilter" ref="rfc5291:Capability">
                    <Number name="CapabilityLength" size="16" endian="big">
                        <Relation type="size" of="CapabilityValue"/>
                    </Number>
                </Block>
                <Block name="GracefulRestart" ref="rfc4724:Capability">
                    <Number name="CapabilityLength" size="16" endian="big">
                        <Relation type="size" of="CapabilityValue"/>
                    </Number>
                </Block>
                <Block name="AS4" ref="rfc6793:Capability">
                    <Number name="CapabilityLength" size="16" endian="big">
                        <Relation type="size" of="CapabilityValue"/>
                    </Number>
                </Block>
                <Block name="DynamicCap" ref="Capability">
                    <Number name="CapabilityLength" size="16" endian="big">
                        <Relation type="size" of="CapabilityValue"/>
                    </Number>
                </Block>
                <Block name="UnknownCapability" ref="Base:BGP4Capability">
                    <Number name="CapabilityLength" size="16" endian="big">
                        <Relation type="size" of="CapabilityValue"/>
                    </Number>
                    <Block name="CapabilityValue">
                        <Blob name="Data"/>
                    </Block>
                </Block>
            </Choice>
        </Block>
    </DataModel>
    <!-- END BGP4 Message Types -->
</Peach>
