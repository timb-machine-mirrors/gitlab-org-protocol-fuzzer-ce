<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"
       author="Deja Vu Security, LLC" description="Dynamic Host Configuration Protocol v4 PIT DataModels" version="0.0.2">
	<!-- Copyright (c) Deja Vu Security, LLC 2013 -->
			 
	<DataModel name="Options">
    <Number name="Type" size="8" endian="big"/>
    <Number name="Length" size="8" endian="big">
      <Relation type="size" of="Value"/>
    </Number>
    <Block name="Value"/>
  </DataModel>
  
	<DataModel name="DHCPv4">
    <Number name="OpCode" size="8" endian="big" value="0x01"/>
    <Number name="HardwareType" size="8" endian="big" value="0x01"/>
		<Number name="HardwareAddrLength" size="8" endian="big">
			<Relation type="size" of="ClientMacAndPadding.ClientBlock.ClientMacAddr1"/>
		</Number>
		<Number name="Hops" size="8" endian="big" value="0"/>
		<Number name="TransactionId" size="32" endian="big" value="0x01963ac8"/>
		<Number name="SecondsElapsed" size="16"  endian="big" value="0"/>
		<Flags size="16">
			<Flag name="BroadCast" size="1" position="0"/>
		</Flags>
		<Block name="CIAddrBlock" length="4"> <!--Used for cracking-->
			<String name="CIAddr" value="##SourceIPv4##">
				<Transformer class="Ipv4StringToOctet"/>
			</String>
		</Block>
		<Block name="YIAddrBlock" length="4"> <!--Used for cracking-->
			<String name="YIAddr"  value="##SourceIPv4##">
				<Transformer class="Ipv4StringToOctet"/>
			</String>
		</Block>
		<Block name="SIAddrBlock" length="4"> <!--Used for cracking-->
			<String name="SIAddr" value="##TargetIPv4##">
				<Transformer class="Ipv4StringToOctet"/>
			</String>
		</Block>
		<Block name="GIAddrBlock" length="4"> <!--Used for cracking-->
			<String name="GIAddr"  value="##TargetIPv4##">
				<Transformer class="Ipv4StringToOctet"/>
			</String>
		</Block>
		<Block name="ClientMacAndPadding">
			<Block name="ClientBlock">
				<Blob name="ClientMacAddr1" valueType="hex" value="0800c0565000"/>
			</Block>
			<Padding alignment="128"/>
		</Block>
		<Blob name="ServerName" length="64"/>
		<Blob name="BootFileName" length="128"/>
		<Blob name="MagicCookie" valueType="hex" value="63825363"/>
		<Block name="Options"/>
  </DataModel>
	
  <DataModel name="DHCPv4Request" ref="DHCPv4">
    <Number name="OpCode" size="8" endian="big" value="0x01"/>
		<Block name="CIAddrBlock" length="4"> <!--Used for cracking-->
			<String name="CIAddr" value="##SourceIPv4##">
				<Transformer class="Ipv4StringToOctet"/>
			</String>
		</Block>
		<Blob name="YIAddr" length="4"/>
		<Blob name="SIAddr" length="4"/>
		<Blob name="GIAddr" length="4"/>
		<Block name="ClientMacAndPadding">
			<Block name="ClientBlock">
				<Blob name="ClientMacAddr1" valueType="hex" value="0800c0565000"/>
			</Block>
			<Padding alignment="128"/>
		</Block>
		<Blob name="ServerName" length="64"/>
		<Blob name="BootFileName" length="128"/>
		<Blob name="MagicCookie" valueType="hex" value="63825363"/>
		<Block name="Options">
			<Block name="DhcpMessageType" ref="Options">
				<Number name="Type" size="8" endian="big" value="53"/>
				<Number name="Length" size="8" endian="big">
					<Relation type="size" of="Value"/>
				</Number>
				<Block name="Value">
					<Number size="8" value="3"/>
				</Block>
			</Block>
			<Block name="HostName" ref="Options">
				<Number name="Type" size="8" endian="big" value="12"/>
				<Number name="Length" size="8" endian="big">
					<Relation type="size" of="Value"/>
				</Number>
				<Block name="Value">
					<String value="Your Computer"/>
				</Block>
			</Block>
			<Block name="ParamReqList" ref="Options">
				<Number name="Type" size="8" endian="big" value="55"/>
				<Number name="Length" size="8" endian="big">
					<Relation type="size" of="Value"/>
				</Number>
				<Block name="Value">
					<Number size="8" value="1"/>
					<Number size="8" value="28"/>
					<Number size="8" value="2"/>
					<Number size="8" value="3"/>
					<Number size="8" value="15"/>
					<Number size="8" value="6"/>
					<Number size="8" value="119"/>
					<Number size="8" value="12"/>
					<Number size="8" value="44"/>
					<Number size="8" value="47"/>
					<Number size="8" value="26"/>
					<Number size="8" value="121"/>
					<Number size="8" value="42"/>
				</Block>
			</Block>
			<Number name="End" size="8" value="255"/>
		</Block>
  </DataModel>
	
	<DataModel name="DHCPv4Acknowledgement" ref="DHCPv4">
		<Number name="OpCode" size="8" endian="big" value="0x02"/>
		<Blob name="GIAddr" length="4"/>
		<Blob name="BootFileName" length="128"/>
		<Blob name="ClientMacAndPadding.ClientBlock.ClientMacAddr1" valueType="hex" value="##TargetMAC##"/>
		<Block name="Options">
			<Block name="DhcpMessageType" ref="Options">
				<Number name="Type" size="8" endian="big" value="53"/>
				<Number name="Length" size="8" endian="big">
					<Relation type="size" of="Value"/>
				</Number>
				<Block name="Value">
					<Number size="8" value="5"/>
				</Block>
			</Block>
			<Block name="DhcpServerId" ref="Options">
				<Number name="Type" size="8" endian="big" value="54"/>
				<Number name="Length" size="8" endian="big">
					<Relation type="size" of="Value"/>
				</Number>
				<Block name="Value">
					<Block name="DhcpServerIPBlock" length="4"> <!--Used for cracking-->
						<String name="DHCPServerIP" value="##DHCPServerIP##">
							<Transformer class="Ipv4StringToOctet"/>
						</String>
					</Block>
				</Block>
			</Block>
			<Block name="SubnetMask" ref="Options">
				<Number name="Type" size="8" endian="big" value="1"/>
				<Number name="Length" size="8" endian="big">
					<Relation type="size" of="Value"/>
				</Number>
				<Block name="Value">
					<Block name="SubnetMaskBlock" length="4"> <!--Used for cracking-->
						<String name="SubnetMask" value="##SubnetMask##">
							<Transformer class="Ipv4StringToOctet"/>
						</String>
					</Block>
				</Block>
			</Block>
			<Block name="BroadcastAddress" ref="Options">
				<Number name="Type" size="8" endian="big" value="28"/>
				<Number name="Length" size="8" endian="big">
					<Relation type="size" of="Value"/>
				</Number>
				<Block name="Value">
					<Block name="BcastAddrBlock" length="4"> <!--Used for cracking-->
						<String name="BcastAddr" value="##BroadcastIP##">
							<Transformer class="Ipv4StringToOctet"/>
						</String>
					</Block>
				</Block>
			</Block>
			<Block name="Router" ref="Options">
				<Number name="Type" size="8" endian="big" value="3"/>
				<Number name="Length" size="8" endian="big">
					<Relation type="size" of="Value"/>
				</Number>
				<Block name="Value">
					<Block name="RouterIPBlock" length="4"> <!--Used for cracking-->
						<String name="RouterIP" value="##RouterIP##">
							<Transformer class="Ipv4StringToOctet"/>
						</String>
					</Block>
				</Block>
			</Block>
			<Block name="DomainName" ref="Options">
				<Number name="Type" size="8" endian="big" value="15"/>
				<Number name="Length" size="8" endian="big">
					<Relation type="size" of="Value"/>
				</Number>
				<Block name="Value">
					<String value="##DomainName##"/>
				</Block>
			</Block>
			<Block name="DomainNameServer" ref="Options">
				<Number name="Type" size="8" endian="big" value="6"/>
				<Number name="Length" size="8" endian="big">
					<Relation type="size" of="Value"/>
				</Number>
				<Block name="Value">
					<Block name="DNSIPBlock" length="4"> <!--Used for cracking-->
						<String name="DNSIP" value="##DNS##">
							<Transformer class="Ipv4StringToOctet"/>
						</String>
					</Block>
				</Block>
			</Block>
			<Block name="NetBiosNameServer" ref="Options">
				<Number name="Type" size="8" endian="big" value="44"/>
				<Number name="Length" size="8" endian="big">
					<Relation type="size" of="Value"/>
				</Number>
				<Block name="Value">
					<Block name="NetBiosBlock" length="4"> <!--Used for cracking-->
						<String name="NetBios" value="##NetBios##">
							<Transformer class="Ipv4StringToOctet"/>
						</String>
					</Block>
				</Block>
			</Block>
			<Number name="End" size="8" value="255"/>
		</Block>
	</DataModel>
</Peach>
<!-- end -->