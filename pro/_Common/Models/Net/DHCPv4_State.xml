<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"
       author="Deja Vu Security, LLC" description="Dynamic Host Configuration Protocol v4 PIT StateModels" version="0.0.2">
	<!-- Copyright (c) Deja Vu Security, LLC 2013 -->

	<Include ns="DHCPv4" src="file:##PitLibraryPath##/_Common/Models/Net/DHCPv4_Data.xml"/>

	<StateModel name="Client" initialState="Initial">
		<State name="Initial">
			<Action name="Discover" type="output">
				<DataModel ref="DHCPv4:Discover"/>
				<Data>
					<Field name="Payload.Header.Identification" value="0xa836"/>
				</Data>
			</Action>

			<Action name="Offer" type="input">
				<DataModel ref="DHCPv4:Response"/>
			</Action>

			<Action type="slurp" valueXpath="//Offer//YourIPAddress" setXpath="//Request//RequestedIPAddress/Value"/>
			<Action type="slurp" valueXpath="//Offer//NextServerIPAddress" setXpath="//Request//DhcpServerIdentifier/Value"/>

			<Action type="slurp" valueXpath="//Offer//YourIPAddress" setXpath="//Release//ClientIPAddress"/>
			<Action type="slurp" valueXpath="//Offer//NextServerIPAddress" setXpath="//Release//DhcpServerIdentifier/Value"/>

			<Action name="Request" type="output">
				<DataModel ref="DHCPv4:Request"/>
				<Data>
					<Field name="Payload.Header.Identification" value="0xa837"/>
				</Data>
			</Action>

			<Action name="Ack" type="input">
				<DataModel ref="DHCPv4:Response"/>
			</Action>

			<Action name="Release" type="output">
				<DataModel ref="DHCPv4:Release"/>
			</Action>
		</State>
	</StateModel>
</Peach>
<!-- end -->