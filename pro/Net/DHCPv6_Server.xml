<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"
       author="Deja Vu Security, LLC" description="Dynamic Host Configuration Protocol v6 PIT" version="0.0.2">
	<!-- Copyright (c) Deja Vu Security, LLC 2013 -->

	<Include ns="States" src="file:##PitLibraryPath##/_Common/Models/Net/DHCPv6_State.xml"/>

	<Agent name="DHCPTestClient">
    <Monitor class="LinuxCrashMonitor"/>
    <Monitor class="Process">
      <Param name="Executable" value="dhclient" />
      <Param name="Arguments" value="-lf /dev/null -6 -d ##TargetInterface##" />
    </Monitor>
	</Agent>

  <Test name="Default">
		<StateModel ref="States:Server"/>

		<Agent ref="DHCPTestClient"/>

    <Publisher class="Udp" name="LisentenPublisher">
      <Param name="Host" value="##MulticastDHCP##"/>
      <Param name="Port" value="##TargetPort##"/>
      <Param name="SrcPort" value="##SourcePort##"/>
      <Param name="Interface" value="##Interface##"/>
      <Param name="Timeout" value="36000"/>
    </Publisher>

		<Publisher class="Udp" name="SendPublisher">
      <Param name="Host" value="##TargetIPv6##"/>
      <Param name="Port" value="##TargetPort##"/>
      <Param name="SrcPort" value="##SourcePort##"/>
      <Param name="Interface" value="##SourceIPv6##"/>
			<Param name="Timeout" value="36000"/>
    </Publisher>

		<Publisher class="ConsoleHex" name="TestPublisher"/>

    <Strategy class="##Strategy##"/>

    <Logger class="File">
      <Param name="Path" value="##LoggerPath##"/>
    </Logger>
  </Test>
</Peach>
<!-- end -->
