<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
			 xsi:schemaLocation="http://peachfuzzer.com/2012/Peach ../peach.xsd"
       author="Deja Vu Security, LLC" description="File  Protocol PIT" version="0.0.2">
  <!-- Copyright (c) Deja Vu Security, LLC 2013 -->

	<Include ns="FTP" src="file:##PitLibraryPath##/_Common/Models/Net/ftp_State.xml"/>

	<Test name="Default">
		<StateModel ref="FTP:ClientActive"/>

		<Publisher class="Tcp" name="CommandPublisher">
			<Param name="Host" value="##TargetIPv4##"/>
			<Param name="Port" value="##TargetPort##"/>
      <Param name="Timeout" value="10000"/>
		</Publisher>

    <!-- Used by client state for data port in active mode -->
    <Publisher name="DataListner" class="TcpListener">
      <Param name="Interface" value="##SourceIPv4##"/>
      <Param name="Port" value="##DataPort##"/>
      <Param name="AcceptTimeout" value="10000"/>
    </Publisher>

		<Strategy class="##Strategy##"/>
		<Logger class="File" >
			<Param name="Path" value="##LoggerPath##"/>
		</Logger>
	</Test>

  <Test name="Passive">
    <StateModel ref="FTP:ClientPassive"/>

    <Publisher class="Tcp" name="CommandPublisher">
      <Param name="Host" value="##TargetIPv4##"/>
      <Param name="Port" value="##TargetPort##"/>
      <Param name="Timeout" value="10000"/>
    </Publisher>

    <!-- Used by client state for data port in passive mode -->
    <Publisher class="Tcp" name="DataPublisher">
      <Param name="Host" value="##TargetIPv4##"/>
      <Param name="Port" value="##TargetPort##"/>
      <Param name="Timeout" value="10000"/>
    </Publisher>

    <Strategy class="##Strategy##"/>
    <Logger class="File" >
      <Param name="Path" value="##LoggerPath##"/>
    </Logger>
  </Test>
</Peach>
<!--END-->
