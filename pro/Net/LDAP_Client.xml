<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"
       author="Deja Vu Security, LLC" description="LDAPv3 Pit" version="0.0.2">
	<!-- Copyright (c) Deja Vu Security, LLC 2013 -->

	<Include ns="LDAP" src="file:##PitLibraryPath##/_Common/Models/Net/Ldap_State.xml"/>

	<Agent name="LocalAgent">
		<Monitor name="Network" class="Pcap">
			<Param name="filter" value="tcp"/>
			<Param name="Device" value="##Interface##" />
		</Monitor>
	</Agent>

	<Test name="Default">
		<Agent ref="LocalAgent" />
		<StateModel ref="LDAP:Search"/>

		<Strategy class="##Strategy##"/>

		<Publisher class="Tcp" name="tcp">
			<Param name="Host" value="##TargetIPv4##" />
			<Param name="Port" value="##TargetPort##" />
			<Param name="Timeout" value="##Timeout##"/>
		</Publisher>

		<Logger class="File">
		<Param name="Path" value="##LoggerPath##/Search" />
		</Logger>
	</Test>

	<Test name="Add">
		<Agent ref="LocalAgent" />
		<StateModel ref="LDAP:Add"/>

		<Strategy class="##Strategy##"/>

		<Publisher class="Tcp" name="tcp">
			<Param name="Host" value="##TargetIPv4##" />
			<Param name="Port" value="##TargetPort##" />
			<Param name="Timeout" value="##Timeout##"/>
		</Publisher>

		<Logger class="File">
			<Param name="Path" value="##LoggerPath##/Add" />
		</Logger>
	</Test>

	<Test name="Compare">
		<Agent ref="LocalAgent" />
		<StateModel ref="LDAP:Compare"/>

		<Strategy class="##Strategy##"/>

		<Publisher class="Tcp" name="tcp">
			<Param name="Host" value="##TargetIPv4##" />
			<Param name="Port" value="##TargetPort##" />
			<Param name="Timeout" value="##Timeout##"/>
		</Publisher>

		<Logger class="File">
			<Param name="Path" value="##LoggerPath##/Compare" />
		</Logger>
	</Test>

	<Test name="Delete">
		<Agent ref="LocalAgent" />
		<StateModel ref="LDAP:Delete"/>

		<Strategy class="##Strategy##"/>

		<Publisher class="Tcp" name="tcp">
			<Param name="Host" value="##TargetIPv4##" />
			<Param name="Port" value="##TargetPort##" />
			<Param name="Timeout" value="##Timeout##"/>
		</Publisher>

		<Logger class="File">
			<Param name="Path" value="##LoggerPath##/Delete" />
		</Logger>
	</Test>

	<Test name="ExtendOp">
		<Agent ref="LocalAgent" />
		<StateModel ref="LDAP:ExtendOp"/>

		<Strategy class="##Strategy##"/>

		<Publisher class="Tcp" name="tcp">
			<Param name="Host" value="##TargetIPv4##" />
			<Param name="Port" value="##TargetPort##" />
			<Param name="Timeout" value="##Timeout##"/>
		</Publisher>

		<Logger class="File">
			<Param name="Path" value="##LoggerPath##/ExtendOp" />
		</Logger>
	</Test>
</Peach>
<!-- end -->
