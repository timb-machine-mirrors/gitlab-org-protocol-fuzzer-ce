<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"
	author="Deja Vu Security, LLC" description="Modbus PIT" version="0.0.1">

	<Include ns="Modbus" src="file:##PitLibraryPath##/_Common/Models/Net/modbus_State.xml"/>

	<Test name="Default">
		<StateModel ref="Modbus:OverTcp"/>

		<Publisher name="ModbusOverTcp" class="Tcp">
			<Param name="Host" value="##TargetIPv4##"/>
			<Param name="Port" value="##TargetPort##" />
			<Param name="Timeout" value="##Timeout##" />
		</Publisher>

		<Strategy class="##Strategy##"/>

		<Logger class="File">
			<Param name="Path" value="##LoggerPath##"/>
		</Logger>
	</Test>

	<Test name="RtuMode">
		<StateModel ref="Modbus:RTUMode"/>

		<Publisher name="ModbusOverSerial" class="SerialPort">
      <Param name="PortName" value="##SerialPort##"/>
      <Param name="Baudrate" value="##Baudrate##"/>
			<Param name="Parity" value="##Parity##"/>
			<Param name="DataBits" value="##DataBits##"/>
			<Param name="StopBits" value="##StopBits##"/>
			<Param name="Handshake" value="##Handshake##"/>
			<Param name="Timeout" value="##Timeout##"/>
    </Publisher>

		<Strategy class="##Strategy##"/>

		<Logger class="File">
			<Param name="Path" value="##LoggerPath##"/>
		</Logger>
	</Test>

	<Test name="AsciiMode">
		<StateModel ref="Modbus:AsciiMode"/>

		<Publisher name="ModbusOverSerial" class="SerialPort">
      <Param name="PortName" value="##SerialPort##"/>
      <Param name="Baudrate" value="##Baudrate##"/>
			<Param name="Parity" value="##Parity##"/>
			<Param name="DataBits" value="##DataBits##"/>
			<Param name="StopBits" value="##StopBits##"/>
			<Param name="Handshake" value="##Handshake##"/>
			<Param name="Timeout" value="##Timeout##"/>
    </Publisher>

		<Strategy class="##Strategy##"/>

		<Logger class="File">
			<Param name="Path" value="##LoggerPath##"/>
		</Logger>
	</Test>
</Peach>
<!-- end -->