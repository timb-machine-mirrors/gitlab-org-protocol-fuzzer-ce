<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
			 xsi:schemaLocation="http://peachfuzzer.com/2012/Peach /peach/peach.xsd"  
       author="Deja Vu Security, LLC" description="PPTX PIT" version="0.0.1">
	<!-- Copyright (c) Deja Vu Security, LLC 2013 -->

	<Include ns="States" src="file:##PitLibraryPath##/_Common/Models/Application/Office_State.xml"/>

	<Agent name="WinAgent">
		<Monitor class="ButtonClicker">
			<Param name="WindowText" value="Do you want to start in safe mode?" />
			<Param name="ButtonName" value="No" />
		</Monitor>

		<Monitor class="ButtonClicker">
			<Param name="WindowText" value="PowerPoint can attempt to repair the presentation" />
			<Param name="ButtonName" value="Repair" />
		</Monitor>
		
		<Monitor class="ButtonClicker">
			<Param name="WindowText" value="Do you still want to open it?" />
			<Param name="ButtonName" value="Yes" />
		</Monitor>

		<Monitor class="PageHeap">
			<Param name="Executable" value="powerpnt.exe"/>
		</Monitor>

		<Monitor class="WindowsDebugger">
			<Param name="CommandLine" value="##Target## fuzzed.pptx" />
			<Param name="CpuPollInterval" value="1000"/>
			<Param name="StartOnCall" value="FuzzMe" />
		</Monitor>
	</Agent>

	<Test name="Default">
		<StateModel ref="States:TheStateModel" />
		
		<Agent ref="##Agent##"/>

		<Publisher name="writer" class="Zip">
			<Param name="FileName" value="fuzzed.pptx" />
		</Publisher>

		<Strategy class="##Strategy##"/>

		<Logger class="File">
			<Param name="Path" value="##LoggerPath##"/>
		</Logger>

		<Logger class="Metrics">
			<Param name="Path" value="##LoggerPath##"/>
		</Logger>
	</Test>
</Peach>
