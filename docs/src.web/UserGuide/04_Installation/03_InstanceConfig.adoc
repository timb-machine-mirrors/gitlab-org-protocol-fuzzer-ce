=== Instance Configuration

This section contains the steps required to configure a new instance of {product}.
Configuring authentication is an optional, but recommended step.

==== Network Configuration

Initial network configuration is performed via a console application.
Additional configuration can be performed through the admin portal located on port 10000.  
The following URL can be used: +https://[IP]:10000/ to access the admin portal.

.{product} Console
image::{images}/Install/ConfigurationConsole.png[]

.Console Advanced Configuration Screen
image::{images}/Install/ConfigurationConsole-Advanced.png[]

.Console Network Configuration Screen
image::{images}/Install/ConfigurationConsole-Networking.png[]

[[Install_ChangeDefaultPassword]]
=== Change Default credentials

Once networking has been configured the very first configuration step is to
set a new password for the default administrative user 'ubuntu' via the admin portal.

==== Step 1: Login to {product} Admin Portal

The admin portal for {product} can be accessed via the folling URL:

  https://[IP]:10000/

Login using the default credentials:

  user: ubuntu
  password: ubuntu

==== Step 2: Navigate to Webmin Users

Using the left hand naviagtion, select 'Webmin', then 'Webmin Users' as shown in the following figure.
Next, click on the user 'root' as shown in the following figure.

.Webmin Users Page
image::{images}/Install/Webmin_Config_ChangeAdminPass-1.png[]

==== Step 3: Set New Password

From the 'Edit Webmin User' page, set the 'Password' drop-down to 'Set to ..' and
type in the new password in the following text entry box as shown in the following image.
Once set, click the 'Save' button.

.Set New Admin Password
image::{images}/Install/Webmin_Config_ChangeAdminPass-2.png[]

==== SSL Certificate Installation

The instance ships with a temporary self-signed SSL certificate.
This certificate should be replaced with a custom self-signed or preferably a legitamit 
SSL certificate from your companies certificate authority.

The admin panel provides several easy to use methods for configuring SSL.
The SSL configuration for the admin panel will be used for {product} as well.
The supported configurations are:

Certificate from Certificate Authority (CA)::
    In this method all files can be set/uploaded or the admin panel can
    generate a certificate signing request (CSR) that can be sent to a
    CA to produce an SSL certificate.
    This is the recommended method.

Let's Encrypt::
    While the option for using Let's Encrypt exists in the admin panel,
    it is not supported by this virtual appliance.

Self-Signed Certificate::
    Generate a new self-signed certificate. 
    This certificate type is better than using the shipped default, but otherwise
    provides the least amount of security.

===== Certificate from CA

Use the following steps to generate a certificate signing request, 
submit it to a CA and finally install the certificate using the {product} admin portal.

====== Step 1: Login to {product} Admin Portal

The admin portal for {product} can be accessed via the folling URL:

  https://[IP]:10000/

Login using the default credentials (user: ubuntu, password: ubuntu) or if they have
already been changed, the new credentials.

====== Step 2: Navigate to SSL Encryption

Using the left hand menu, select "Webmin" and then "Webmin Configuration".
This will bring you to a page with numerous configuration buttons.
As shown in the following figure, select "SSL Encryption".

.Admin Panel SSL Configuration
image::{images}/Install/Webmin_Config_SSL-1.png[]

====== Step 3: Create Certificate Signing Request (CSR)

Next a certificate signing request (CSR) must be generated.
To start this process select the "Certificate Signing Request" tab and
fill in the required information as shown in the following figure.
To generate the CSR click the 'Create Now' button as shown in the 
following figure.

.Create Certificate Sining Request
image::{images}/Install/Webmin_Config_SSL-CSR-1.png[]

====== Step 4: Send Certificate Signing Request to CA

The generated CSR and new private key should be displayed as shown in the 
following figure.
The second field under the label "Successfully generated the following SSL certificate request:"
must now be sent to the certificate authority (CA) to generate a signed SSL certificate.
The field to copy is indicated by the red arrow.

.Generated Certificate Signing Request
image::{images}/Install/Webmin_Config_SSL-CSR-2.png[]

====== Step 5: Upload SSL Certificate

This step requires the PEM encoded SSL Certificate and optional certificate chain, also PEM encoded.
To start, navigate to the "Upload Certificate" tab as shown in the following diagram.
Paste in the full contents of the SSL Certificate file (or use the upload function).
Also paste in the full contents of the chained certificate file (or use the upload funciton).

Once the contents are submitted click the "Save" button as shown in the following figure.
This will complete the SSL configuration.

.Upload SSL Certificate
image::{images}/Install/Webmin_Config_SSL-UploadCert.png[]

===== Self-Signed Certificate

Use the following steps to generate a self-signed SSL certificate using the 
{product} admin portal.

====== Step 1: Login to {product} Admin Portal

The admin portal for {product} can be accessed via the folling URL:

  https://[IP]:10000/

Login using the default credentials (user: ubuntu, password: ubuntu) or if they have
already been changed, the new credentials.

====== Step 2: Navigate to SSL Encryption

Using the left hand menu, select "Webmin" and then "Webmin Configuration".
This will bring you to a page with numerous configuration buttons.
As shown in the following figure, select "SSL Encryption".

.Admin Panel SSL Configuration
image::{images}/Install/Webmin_Config_SSL-1.png[]

====== Step 3: Create Self-Signed Certificate

Select the "Self-Signed Certificate" tab and fill out the 'Create SSL key' form.
Once the form has been completed click the "Create Now" button as shown in the following
figure.

Once the generated the admin portal site will need to be refreshed.

.Self-Signed Certificate
image::{images}/Install/Webmin_Config_SSL-SelfSigned.png[]

==== Authentication

Authentication is currently supported via an Apache reverse proxy.
Apache supports a number of authentication mechanisms from local through LDAP.
The authentication panel gives access to the Apache configuration.

===== Active Directory / LDAP

// TODO

Intructions for configuring active directory or LDAP authentication will
be included in the non-beta {peachug}.
Contact support for assistance until then.

===== Local

// TODO

Intructions for configuring local authentication will
be included in the non-beta {peachug}.
Contact support for assistance until then.
