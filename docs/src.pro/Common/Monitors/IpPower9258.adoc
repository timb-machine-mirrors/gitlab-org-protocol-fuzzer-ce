<<<
[[Monitors_IpPower9258]]
== IpPower9258 Monitor

*Monitor Category*: *Automation*

The _IpPower9258_ monitor controls an IP Power 9258 Network Power Controller (IP9258). The IP9258 consists of four three-prong outlets that support electrical loads of 6 amps at 110 or 240 VAC. Communications between Peach and the IP9258 uses Ethernet cabling. This monitor allows devices plugged into the IP Power 9258 switch to be powered on/off during fuzzing.

Each _IpPower9258_ monitor switches an individual outlet. Use one monitor per outlet to control multiple outlets concurrently. Times that the monitor can switch the power of an outlet include the following:

* At the start or end of a fuzzing run
* At the start or end of each test iteration
* After detecting a fault
* At the start of an iteration that immediately follows a fault

image::{images}/Common/Monitors/IpPower9258.png[scalewidth="75%"]


[NOTE]
===============================

IP Power 9258 is the only networked power switch that Peach supports. If you wish to fuzz another networked power controller or switch, you will need to write your own monitor.

You can purchase "IP Power 9258" Remote Network (or Network AC) Power Controllers from a variety of online retailers.

===============================

TIP: For controlling power to a device by wiring through a relay, Peach provides a monitor for the xref:Monitors_CanaKitRelay[Cana Kit 4-Port USB Relay Controller].

=== Parameters

_Required:_

Host:: Host or IP address (can include HTTP interface port e.g. :8080)
User:: Username
Password:: Password
Port:: Port/Outlet to reset (1, 2, 3, 4)

_Optional:_

PowerOnOffPause:: Pause in milliseconds between power off/power on, default is 500.

When::
+
Details on when to perform a specified action. Specify one of the following values:
+
[cols="1,2" options="header",halign="center"]
|==========================================================
|"When" Setting              |Description
|DetectFault                 |Perform the action when checking for the faulting condition. Requires a regular expression in the +CheckValue+ parameter. Default mode of operation.
|OnStart                     |Run the command when fuzzing session starts. Command runs once per session.
|OnEnd                       |Run the command when fuzzing session stops. Command runs run once per session.
|OnIterationStart            |Run the command at start of each iteration.
|OnIterationEnd              |Run the command at end of each iteration.
|OnFault                     |Run the command when Peach detects a fault.
|OnIterationStartAfterFault  |Run the command at start of an iteration that immediately follows a fault detection.
|OnCall                      |Trigger the command to run from the state model. The command runs when the _StartOnCall_ message is received.
|==========================================================
+
.When Choices for Performing an Action
image::{images}/Common/Monitors/Timings_SSH.png[scalewidth="75%"]



=== Examples
ifdef::peachug[]

.Catch crashes from Movie Player +
====================

This parameter example is from a setup that controls port 1 of a IP Power 9258 Network Power Controller. If the hardware needs to restart (due to a fault), the monitor sends a signal to toggle the power to port 1 off, then back on.

[cols="2,4" options="header",halign="center"]
|==========================================================
|Parameter            |Value
|Host                 |`192.168.1.1:8080`
|User                 |`peach`
|Password             |`power`
|Port                 |`1`
|ResetEveryIteration  |`true`
|==========================================================


====================

endif::peachug[]


ifndef::peachug[]

.Reset power on port 1
========================
[source,xml]
----
<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://peachfuzzer.com/2012/Peach peach.xsd">

  <DataModel name="TheDataModel">
    <Number size="32" signed="false" value="31337" />
  </DataModel>

  <StateModel name="State" initialState="Initial" >
    <State name="Initial">
      <Action type="output">
          <DataModel ref="TheDataModel"/>
      </Action>
    </State>
  </StateModel>

  <Agent name="Local">
   	<Monitor class="IpPower9258">
    	<Param name="Host" value="192.168.1.1:8080" />
    	<Param name="User" value="peach" />
    	<Param name="Password" value="power" />
    	<Param name="Port" value="1" />
    	<Param name="ResetEveryIteration" value="true" />
  	</Monitor>
  </Agent>

  <Test name="Default">
    <StateModel ref="State"/>

    <Agent ref="Local" />

    <Publisher class="ConsoleHex"/>

    <Logger class="File">
      <Param name="Path" value="logs"/>
    </Logger>
  </Test>
</Peach>
----
========================

endif::peachug[]
