:images: ../images
<<<
[[Monitors_ButtonClicker]]
== ButtonClicker Monitor

The _ButtonClicker_ monitor provides automation functionality by clicking buttons 
in the Windows GUI. This monitor runs in the Windows environment. _ButtonClicker_
watches and clicks the appropriate button within the specified window. For example, 
you can specify that _ButtonClicker_ click an "OK" button to perform an action or 
to close a window.

The intent of this monitor is to activate an action, or to close a window keep a 
fuzzing session active. _Buttonclicker_ runs from the beginning of a fuzzing session 
to the end of the session.

For example,

For example, if an application crashes and needs to restart or has trouble starting, it might display a popup window asking to start with a specific set of features that could aid in troubleshooting the cause of failure. A sample popup window consistent with this situation follows:

.{nbsp}
image::{images}/ButtonClickerExample.png[]

Here, the _ButtonClicker_ monitor provides a mouse click to close the popup window 
and to restart Windows in normal mode. The response allows fuzzing to continue instead 
of waiting for a user to respond to the question raised by the window.

NOTE: This monitor is especially useful for applications that re-use a pop-up window 
for many purposes. The window has one title, but the main area of the window can 
display several different messages depending on the context in the application. Another 
monitor to consider for watching popup windows is xref:Monitors_PopupWatcher[PopupWatcher], that monitors popup windows based on the window title rather than matching a string 
in the message body.

=== Parameters

_Required:_

WindowText:: Name of the window or dialog box. Peach performs a string search to 
determine whether matching text occurs in the popup window.
ButtonName:: Text label of the button to click. The label is displayed to the user, 
and is on or around the button that will receive the click.

_Optional:_

None.

[TIP]
====
If Peach has trouble clicking a button, the button might have a link to a shortcut key, and is displayed with an underlined character. Windows does this by inserting an ampersand "&" immediately before the shortcut key within the button label. Further, not all underlining shows in the initial display of the window.

In an application, you can manually force underlining to display in window buttons by 
pressing the <CTRL> or <ALT> key. Once you find the underlining in the application, 
you can adjust the value of the +ButtonName+ parameter for _ButtonClick_ by inserting 
an ampersand (&) immediately before any underlined character. Then, Peach will find the 
button to click.

In Microsoft Word, the Browsing dialog box used to open a document does not immediately 
display underlining in its command buttons. You can see this by following the sequence 
that opens a file:

. Click *File* on the ribbon.
. Click *Open* on the vertical menu.
. Click *Computer* in the Open column.
. Click the *Browse* button. +
The dialog opens and the "Open" button in the lower right corner is not underlined. Press the <ALT> or <CTRL> key to see the underlining as in the following illustration.  
+
image::{images}/UnderliningExample.png[]
====

=== Examples

ifdef::peachug[]

.Basic Usage Example +

This parameter example is from a setup that uses the ButtonClicker monitor. The monitor will respond to the pop-up window that displays when restarting the application after a crash.

The ButtonClicker monitor uses the following parameter settings to click the "No" button in the pop-up window :

[cols="2,4" options="header",halign="center"] 
|==========================================================
|Parameter    |Value
|WindowText   |Do you want to start in safe mode?
|ButtonName   |No
|==========================================================


endif::peachug[]


ifndef::peachug[]

.Basic Usage Example +

This example uses the ButtonClicker monitor to respond to a question from a pop-up window that displays when restarting an application after a crash.

=======================
[source,xml]
----
<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://peachfuzzer.com/2012/Peach peach.xsd">

  <DataModel name="TheDataModel">
    <Number size="32" signed="false" value="31337" />
  </DataModel>

  <StateModel name="State" initialState="Initial" >
    <State name="Initial">
      <Action type="output">
          <DataModel ref="TheDataModel"/>
      </Action>
    </State>
  </StateModel>

  <Agent name="Local">
    <Monitor class="ButtonClicker">
      <Param name="WindowText" value="Do you want to start in safe mode?" />
      <Param name="ButtonName" value="No" />
    </Monitor>
  </Agent>

  <Test name="Default">
    <StateModel ref="State"/>

    <Agent ref="Local" />

    <Publisher class="ConsoleHex"/>

    <Logger class="File">
      <Param name="Path" value="logs"/>
    </Logger>
  </Test>
</Peach>
----

=======================

endif::peachug[]
