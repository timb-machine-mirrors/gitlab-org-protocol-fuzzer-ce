<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>XED: Printing (disassembling) Instructions</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<h1>Printing (disassembling) Instructions</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structxed__format__options__t.html">xed_format_options_t</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Options for the disasembly formatting functions.  <a href="structxed__format__options__t.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structxed__print__info__t.html">xed_print_info_t</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This contains the information used by the various disassembly printers.  <a href="structxed__print__info__t.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>xed_decoded_inst_t Printers</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">XED_DLL_EXPORT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PRINT.html#g988943de2c61305278f50a26bb9945bc">xed_decoded_inst_dump</a> (const <a class="el" href="structxed__decoded__inst__s.html">xed_decoded_inst_t</a> *p, char *buf, int buflen)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print out all the information about the decoded instruction to the buffer buf whose length is maximally buflen.  <a href="#g988943de2c61305278f50a26bb9945bc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">XED_DLL_EXPORT <a class="el" href="xed-types_8h.html#d355c921b747945a82d62233a599c7b5">xed_bool_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PRINT.html#gfc335b6bbcbfaadcf3b4c5174c9e9444">xed_decoded_inst_dump_xed_format</a> (const <a class="el" href="structxed__decoded__inst__s.html">xed_decoded_inst_t</a> *p, char *buf, int buflen, xed_uint64_t runtime_address)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print the instruction information in a verbose format.  <a href="#gfc335b6bbcbfaadcf3b4c5174c9e9444"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">XED_DLL_EXPORT <a class="el" href="xed-types_8h.html#d355c921b747945a82d62233a599c7b5">xed_bool_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PRINT.html#gc09057f278cb90a5faefb39aaf4431e0">xed_format_context</a> (<a class="el" href="xed-syntax-enum_8h.html#226c37dc9f1af9e61dad79dc5f65bc9f">xed_syntax_enum_t</a> syntax, const <a class="el" href="structxed__decoded__inst__s.html">xed_decoded_inst_t</a> *xedd, char *out_buffer, int buffer_len, xed_uint64_t runtime_instruction_address, void *context, <a class="el" href="group__PRINT.html#g4e08b30c6cbb92b04c597d386bb68233">xed_disassembly_callback_fn_t</a> symbolic_callback)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disassemble the decoded instruction using the specified syntax.  <a href="#gc09057f278cb90a5faefb39aaf4431e0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">XED_DLL_EXPORT <a class="el" href="xed-types_8h.html#d355c921b747945a82d62233a599c7b5">xed_bool_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PRINT.html#gf353624c80f5c7d770bbdfc95a54acba">xed_format_generic</a> (<a class="el" href="structxed__print__info__t.html">xed_print_info_t</a> *pi)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disassemble the instruction information to a buffer.  <a href="#gf353624c80f5c7d770bbdfc95a54acba"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Formatting options</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">XED_DLL_EXPORT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PRINT.html#g3c3cafaba9b3bd494f7a908f9e5af1b7">xed_format_set_options</a> (<a class="el" href="structxed__format__options__t.html">xed_format_options_t</a> format_options)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Optionally, customize the disassembly formatting options by passing in a <a class="el" href="structxed__format__options__t.html">xed_format_options_t</a> structure.  <a href="#g3c3cafaba9b3bd494f7a908f9e5af1b7"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef int(*)&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PRINT.html#g4e08b30c6cbb92b04c597d386bb68233">xed_disassembly_callback_fn_t</a> (xed_uint64_t address, char *symbol_buffer, xed_uint32_t buffer_length, xed_uint64_t *offset, void *context)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>The input address for which we want symbolic name and offset </td></tr>
  </table>
</dl>
 <a href="#g4e08b30c6cbb92b04c597d386bb68233"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">XED_DLL_EXPORT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PRINT.html#gbbb091822def59d7cf56b123a60f2439">xed_init_print_info</a> (<a class="el" href="structxed__print__info__t.html">xed_print_info_t</a> *pi)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
There are two primary instruction printing functions: <a class="el" href="group__PRINT.html#gf353624c80f5c7d770bbdfc95a54acba">xed_format_generic()</a> and <a class="el" href="group__PRINT.html#gc09057f278cb90a5faefb39aaf4431e0">xed_format_context()</a> . Both emit disassembly to a user specified buffer. <a class="el" href="group__PRINT.html#gf353624c80f5c7d770bbdfc95a54acba">xed_format_generic()</a> takes all the required information in a pointer to a structure of type <a class="el" href="structxed__print__info__t.html">xed_print_info_t</a>. In contrast, <a class="el" href="group__PRINT.html#gc09057f278cb90a5faefb39aaf4431e0">xed_format_context()</a>, takes its arguments individually. Both versions can take a void* context argument that is passed to an optional symbolic disassembly callback function.<p>
The disassembly dialect (order of operands and formatting) is specified by the <a class="el" href="xed-syntax-enum_8h.html#226c37dc9f1af9e61dad79dc5f65bc9f">xed_syntax_enum_t</a> parameter. For finer control on certain aspects of disassembly, the parameter to <a class="el" href="group__PRINT.html#gf353624c80f5c7d770bbdfc95a54acba">xed_format_generic()</a> has a field specifing lower level formatting options (<a class="el" href="structxed__format__options__t.html">xed_format_options_t</a>). <hr><h2>Typedef Documentation</h2>
<a class="anchor" name="g4e08b30c6cbb92b04c597d386bb68233"></a><!-- doxytag: member="xed-disas.h::xed_disassembly_callback_fn_t" ref="g4e08b30c6cbb92b04c597d386bb68233" args="(xed_uint64_t address, char *symbol_buffer, xed_uint32_t buffer_length, xed_uint64_t *offset, void *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(*) <a class="el" href="group__PRINT.html#g4e08b30c6cbb92b04c597d386bb68233">xed_disassembly_callback_fn_t</a>(xed_uint64_t address, char *symbol_buffer, xed_uint32_t buffer_length, xed_uint64_t *offset, void *context)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>The input address for which we want symbolic name and offset </td></tr>
  </table>
</dl>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>symbol_buffer</em>&nbsp;</td><td>A buffer to hold the symbol name. The callback function should fill this in and terminate with a null byte. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buffer_length</em>&nbsp;</td><td>The maximum length of the symbol_buffer including then null </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>offset</em>&nbsp;</td><td>A pointer to a xed_uint64_t to hold the offset from the provided symbol. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>This void* pointer passed to the disassembler's new interface so that the caller can identify the proper context against which to resolve the symbols. The disassembler passes this value to the callback. The legacy formatters that do not have context will pass zero for this parameter. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on failure, 1 on success. </dd></dl>

<p>
Definition at line <a class="el" href="xed-disas_8h-source.html#l00058">58</a> of file <a class="el" href="xed-disas_8h-source.html">xed-disas.h</a>.
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g988943de2c61305278f50a26bb9945bc"></a><!-- doxytag: member="xed-decoded-inst-api.h::xed_decoded_inst_dump" ref="g988943de2c61305278f50a26bb9945bc" args="(const xed_decoded_inst_t *p, char *buf, int buflen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XED_DLL_EXPORT void xed_decoded_inst_dump           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structxed__decoded__inst__s.html">xed_decoded_inst_t</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>buflen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Print out all the information about the decoded instruction to the buffer buf whose length is maximally buflen. 
<p>
This is for debugging. 
</div>
</div><p>
<a class="anchor" name="gfc335b6bbcbfaadcf3b4c5174c9e9444"></a><!-- doxytag: member="xed-decoded-inst-api.h::xed_decoded_inst_dump_xed_format" ref="gfc335b6bbcbfaadcf3b4c5174c9e9444" args="(const xed_decoded_inst_t *p, char *buf, int buflen, xed_uint64_t runtime_address)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XED_DLL_EXPORT <a class="el" href="xed-types_8h.html#d355c921b747945a82d62233a599c7b5">xed_bool_t</a> xed_decoded_inst_dump_xed_format           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structxed__decoded__inst__s.html">xed_decoded_inst_t</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>buflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">xed_uint64_t&nbsp;</td>
          <td class="paramname"> <em>runtime_address</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Print the instruction information in a verbose format. 
<p>
This is for debugging. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>p</em>&nbsp;</td><td>a <a class="el" href="group__DEC.html#gc566768d37da62eafbbda459f6fec3ac">xed_decoded_inst_t</a> for a decoded instruction </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>a buffer to write the disassembly in to. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buflen</em>&nbsp;</td><td>maximum length of the disassembly buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>runtime_address</em>&nbsp;</td><td>the address of the instruction being disassembled. If zero, the offset is printed for relative branches. If nonzero, XED attempts to print the target address for relative branches. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns 0 if the disassembly fails, 1 otherwise. </dd></dl>

</div>
</div><p>
<a class="anchor" name="gc09057f278cb90a5faefb39aaf4431e0"></a><!-- doxytag: member="xed-decoded-inst-api.h::xed_format_context" ref="gc09057f278cb90a5faefb39aaf4431e0" args="(xed_syntax_enum_t syntax, const xed_decoded_inst_t *xedd, char *out_buffer, int buffer_len, xed_uint64_t runtime_instruction_address, void *context, xed_disassembly_callback_fn_t symbolic_callback)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XED_DLL_EXPORT <a class="el" href="xed-types_8h.html#d355c921b747945a82d62233a599c7b5">xed_bool_t</a> xed_format_context           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="xed-syntax-enum_8h.html#226c37dc9f1af9e61dad79dc5f65bc9f">xed_syntax_enum_t</a>&nbsp;</td>
          <td class="paramname"> <em>syntax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structxed__decoded__inst__s.html">xed_decoded_inst_t</a> *&nbsp;</td>
          <td class="paramname"> <em>xedd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>out_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>buffer_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">xed_uint64_t&nbsp;</td>
          <td class="paramname"> <em>runtime_instruction_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__PRINT.html#g4e08b30c6cbb92b04c597d386bb68233">xed_disassembly_callback_fn_t</a>&nbsp;</td>
          <td class="paramname"> <em>symbolic_callback</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Disassemble the decoded instruction using the specified syntax. 
<p>
The output buffer must be at least 25 bytes long. Returns true if disassembly proceeded without errors. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>syntax</em>&nbsp;</td><td>a <a class="el" href="xed-syntax-enum_8h.html#226c37dc9f1af9e61dad79dc5f65bc9f">xed_syntax_enum_t</a> the specifies the disassembly format </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>xedd</em>&nbsp;</td><td>a <a class="el" href="group__DEC.html#gc566768d37da62eafbbda459f6fec3ac">xed_decoded_inst_t</a> for a decoded instruction </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>out_buffer</em>&nbsp;</td><td>a buffer to write the disassembly in to. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buffer_len</em>&nbsp;</td><td>maximum length of the disassembly buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>runtime_instruction_address</em>&nbsp;</td><td>the address of the instruction being disassembled. If zero, the offset is printed for relative branches. If nonzero, XED attempts to print the target address for relative branches. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>A void* used only for the call back routine for symbolic disassembly if one is provided. Can be zero. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>symbolic_callback</em>&nbsp;</td><td>A function pointer for obtaining symbolic disassembly. Can be zero. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns 0 if the disassembly fails, 1 otherwise. </dd></dl>

</div>
</div><p>
<a class="anchor" name="gf353624c80f5c7d770bbdfc95a54acba"></a><!-- doxytag: member="xed-decoded-inst-api.h::xed_format_generic" ref="gf353624c80f5c7d770bbdfc95a54acba" args="(xed_print_info_t *pi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XED_DLL_EXPORT <a class="el" href="xed-types_8h.html#d355c921b747945a82d62233a599c7b5">xed_bool_t</a> xed_format_generic           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structxed__print__info__t.html">xed_print_info_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pi</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Disassemble the instruction information to a buffer. 
<p>
See the <a class="el" href="structxed__print__info__t.html">xed_print_info_t</a> for the required public fields of the argument. This is the preferred method of doing disassembly. The output buffer must be at least 25 bytes long. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pi</em>&nbsp;</td><td>a <a class="el" href="structxed__print__info__t.html">xed_print_info_t</a> </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns 0 if the disassembly fails, 1 otherwise. </dd></dl>

</div>
</div><p>
<a class="anchor" name="g3c3cafaba9b3bd494f7a908f9e5af1b7"></a><!-- doxytag: member="xed-format-options.h::xed_format_set_options" ref="g3c3cafaba9b3bd494f7a908f9e5af1b7" args="(xed_format_options_t format_options)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XED_DLL_EXPORT void xed_format_set_options           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structxed__format__options__t.html">xed_format_options_t</a>&nbsp;</td>
          <td class="paramname"> <em>format_options</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Optionally, customize the disassembly formatting options by passing in a <a class="el" href="structxed__format__options__t.html">xed_format_options_t</a> structure. 
<p>

</div>
</div><p>
<a class="anchor" name="gbbb091822def59d7cf56b123a60f2439"></a><!-- doxytag: member="xed-print-info.h::xed_init_print_info" ref="gbbb091822def59d7cf56b123a60f2439" args="(xed_print_info_t *pi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XED_DLL_EXPORT void xed_init_print_info           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structxed__print__info__t.html">xed_print_info_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pi</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Wed Jan 21 02:17:24 2015 for XED by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
